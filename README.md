# æ¤ç‰©ç§ç±»è¯†åˆ«æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://kdocs.cn/l/cszuIiCKVNis)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€å…¨çƒç”Ÿæ€ç¯å¢ƒçš„å˜åŒ–å’Œäººä»¬å¯¹æ¤ç‰©å¤šæ ·æ€§è®¤è¯†çš„åŠ æ·±ï¼Œæ¤ç‰©ç§ç±»çš„è¯†åˆ«ä¸åˆ†ç±»åœ¨ç”Ÿæ€ä¿æŠ¤ã€å†œä¸šç”Ÿäº§å’Œå›­è‰ºç®¡ç†ç­‰é¢†åŸŸçš„é‡è¦æ€§æ—¥ç›Šå‡¸æ˜¾ã€‚å°¤å…¶æ˜¯åœ¨çƒ­å¸¦å’Œäºšçƒ­å¸¦åœ°åŒºï¼Œæ¤ç‰©ç§ç±»ç¹å¤šï¼Œå°¤å…¶æ˜¯è§‚èµæ¤ç‰©å¦‚èŠ‹å¤´ç§‘æ¤ç‰©ï¼ˆAglaonemaï¼‰å› å…¶ç‹¬ç‰¹çš„å½¢æ€å’Œè‰²å½©å—åˆ°å¹¿æ³›å–œçˆ±ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿçš„æ¤ç‰©è¯†åˆ«æ–¹æ³•å¾€å¾€ä¾èµ–äºäººå·¥è§‚å¯Ÿå’Œä¸“ä¸šçŸ¥è¯†ï¼Œæ•ˆç‡ä½ä¸‹ä¸”å®¹æ˜“å—åˆ°ä¸»è§‚å› ç´ çš„å½±å“ã€‚å› æ­¤ï¼ŒåŸºäºè®¡ç®—æœºè§†è§‰å’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è‡ªåŠ¨åŒ–æ¤ç‰©è¯†åˆ«ç³»ç»Ÿåº”è¿è€Œç”Ÿï¼Œæˆä¸ºç ”ç©¶çš„çƒ­ç‚¹ã€‚

YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶é«˜æ•ˆçš„å®æ—¶ç›®æ ‡æ£€æµ‹èƒ½åŠ›è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚æœ€æ–°çš„YOLOv8æ¨¡å‹åœ¨ç²¾åº¦å’Œé€Ÿåº¦ä¸Šéƒ½æœ‰äº†æ˜¾è‘—æå‡ï¼Œä¸ºæ¤ç‰©ç§ç±»è¯†åˆ«æä¾›äº†æ–°çš„æŠ€æœ¯åŸºç¡€ã€‚é€šè¿‡å¯¹YOLOv8æ¨¡å‹çš„æ”¹è¿›ï¼Œç»“åˆç‰¹å®šçš„æ¤ç‰©æ•°æ®é›†ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜è¯†åˆ«çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚ä»¥Aglaonemaä¸ºä¾‹ï¼Œè¯¥æ¤ç‰©ç§ç±»ä¸‹æœ‰16ä¸ªä¸åŒçš„åˆ†ç±»ï¼Œæ¶µç›–äº†å¤šç§å½¢æ€ç‰¹å¾å’Œè‰²å½©å˜åŒ–ï¼Œæ„æˆäº†ä¸€ä¸ªå¤æ‚çš„è¯†åˆ«ä»»åŠ¡ã€‚ç°æœ‰çš„æ•°æ®é›†åŒ…å«1300å¼ é«˜è´¨é‡çš„å›¾åƒï¼Œä¸ºæ¨¡å‹çš„è®­ç»ƒå’ŒéªŒè¯æä¾›äº†ä¸°å¯Œçš„æ ·æœ¬æ”¯æŒã€‚

åœ¨æ¤ç‰©ç§ç±»è¯†åˆ«çš„ç ”ç©¶ä¸­ï¼Œæ•°æ®é›†çš„æ„å»ºå’Œæ ‡æ³¨æ˜¯è‡³å…³é‡è¦çš„ä¸€ç¯ã€‚é€šè¿‡å¯¹Aglaonemaçš„16ä¸ªåˆ†ç±»è¿›è¡Œè¯¦ç»†æ ‡æ³¨ï¼Œç ”ç©¶è€…èƒ½å¤Ÿåˆ©ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹è¿›è¡Œæœ‰æ•ˆçš„ç‰¹å¾æå–å’Œåˆ†ç±»ã€‚æ”¹è¿›YOLOv8æ¨¡å‹ä¸ä»…èƒ½å¤Ÿæå‡å¯¹ä¸åŒæ¤ç‰©ç§ç±»çš„è¯†åˆ«èƒ½åŠ›ï¼Œè¿˜èƒ½åœ¨å¤„ç†å¤æ‚èƒŒæ™¯å’Œå…‰ç…§å˜åŒ–æ—¶å±•ç°å‡ºæ›´å¼ºçš„é€‚åº”æ€§ã€‚è¿™ä¸€ç ”ç©¶çš„æ„ä¹‰åœ¨äºï¼Œä¸ä»…å¯ä»¥ä¸ºæ¤ç‰©åˆ†ç±»æä¾›é«˜æ•ˆçš„å·¥å…·ï¼Œè¿˜èƒ½æ¨åŠ¨ç›¸å…³é¢†åŸŸçš„ç ”ç©¶è¿›å±•ï¼Œå¦‚ç”Ÿæ€ç›‘æµ‹ã€æ¤ç‰©ä¿æŠ¤å’Œç”Ÿç‰©å¤šæ ·æ€§ç ”ç©¶ã€‚

æ­¤å¤–ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ¤ç‰©ç§ç±»è¯†åˆ«ç³»ç»Ÿè¿˜å…·æœ‰å¹¿æ³›çš„åº”ç”¨å‰æ™¯ã€‚åœ¨å†œä¸šç”Ÿäº§ä¸­ï¼ŒåŠæ—¶å‡†ç¡®åœ°è¯†åˆ«æ¤ç‰©ç§ç±»æœ‰åŠ©äºå†œæ°‘è¿›è¡Œç§‘å­¦ç®¡ç†ï¼Œæé«˜ä½œç‰©äº§é‡å’Œè´¨é‡ã€‚åœ¨å›­è‰ºç®¡ç†ä¸­ï¼Œå¿«é€Ÿè¯†åˆ«ä¸åŒçš„è§‚èµæ¤ç‰©å¯ä»¥å¸®åŠ©å›­è‰ºå¸ˆè¿›è¡Œåˆç†çš„æ¤ç‰©é…ç½®å’Œå…»æŠ¤ã€‚åœ¨ç”Ÿæ€ä¿æŠ¤æ–¹é¢ï¼Œå‡†ç¡®çš„æ¤ç‰©ç§ç±»è¯†åˆ«æœ‰åŠ©äºè¯„ä¼°ç”Ÿæ€ç³»ç»Ÿçš„å¥åº·çŠ¶å†µå’Œç”Ÿç‰©å¤šæ ·æ€§ï¼Œä¸ºä¿æŠ¤æªæ–½çš„åˆ¶å®šæä¾›ç§‘å­¦ä¾æ®ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ¤ç‰©ç§ç±»è¯†åˆ«ç³»ç»Ÿä¸ä»…åœ¨æŠ€æœ¯ä¸Šå…·æœ‰åˆ›æ–°æ€§ï¼Œæ›´åœ¨ç”Ÿæ€ä¿æŠ¤ã€å†œä¸šç”Ÿäº§å’Œå›­è‰ºç®¡ç†ç­‰é¢†åŸŸå±•ç°å‡ºé‡è¦çš„åº”ç”¨ä»·å€¼ã€‚é€šè¿‡æ·±å…¥ç ”ç©¶å’Œå¼€å‘è¿™ä¸€ç³»ç»Ÿï¼Œèƒ½å¤Ÿä¸ºæ¤ç‰©ç§ç±»çš„è‡ªåŠ¨è¯†åˆ«æä¾›æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œæ¨åŠ¨ç›¸å…³é¢†åŸŸçš„ç§‘å­¦ç ”ç©¶å’Œå®è·µåº”ç”¨ï¼Œä¸ºå®ç°å¯æŒç»­å‘å±•ç›®æ ‡è´¡çŒ®åŠ›é‡ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1aR4ue3EBw/)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†è¯¦ç»†æ•°æ®ï¼ˆç±»åˆ«æ•°ï¼†ç±»åˆ«åï¼‰

nc: 13
names: ['andini', 'big-roy', 'butterfly', 'dona-carmen', 'dud-anjamani', 'harlequin', 'hengheng', 'mahasety', 'red-majesty', 'red-stardust', 'striptis', 'suksom', 'sweet-dream']


##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨æ¤ç‰©ç§ç±»è¯†åˆ«ç³»ç»Ÿçš„ç ”ç©¶ä¸­ï¼Œæ•°æ®é›†çš„æ„å»ºä¸é€‰æ‹©è‡³å…³é‡è¦ã€‚æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†åä¸ºâ€œaglaonemaâ€ï¼Œä¸“é—¨ç”¨äºè®­ç»ƒå’Œæ”¹è¿›YOLOv8æ¨¡å‹ï¼Œä»¥å®ç°å¯¹ä¸åŒæ¤ç‰©ç§ç±»çš„é«˜æ•ˆè¯†åˆ«ã€‚è¯¥æ•°æ®é›†åŒ…å«13ä¸ªç‹¬ç‰¹çš„æ¤ç‰©ç±»åˆ«ï¼Œæ¶µç›–äº†å¤šæ ·çš„â€œaglaonemaâ€å“ç§ï¼Œæ¯ä¸ªç±»åˆ«éƒ½ä»£è¡¨äº†ä¸€ç§ç‰¹å®šçš„æ¤ç‰©ç‰¹å¾ä¸ç”Ÿé•¿ç¯å¢ƒï¼Œç¡®ä¿äº†æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚

â€œaglaonemaâ€æ•°æ®é›†çš„ç±»åˆ«åˆ—è¡¨åŒ…æ‹¬ï¼šandiniã€big-royã€butterflyã€dona-carmenã€dud-anjamaniã€harlequinã€henghengã€mahasetyã€red-majestyã€red-stardustã€striptisã€suksomå’Œsweet-dreamã€‚è¿™äº›ç±»åˆ«ä¸ä»…å±•ç¤ºäº†â€œaglaonemaâ€æ¤ç‰©çš„ä¸°å¯Œå¤šæ ·æ€§ï¼Œä¹Ÿä¸ºæ¨¡å‹æä¾›äº†å……è¶³çš„è®­ç»ƒæ ·æœ¬ï¼Œä»¥ä¾¿åœ¨è¯†åˆ«è¿‡ç¨‹ä¸­æ•æ‰åˆ°æ¯ç§æ¤ç‰©çš„ç‹¬ç‰¹ç‰¹å¾ã€‚

é¦–å…ˆï¼Œandiniä½œä¸ºä¸€ç§å¸¸è§çš„â€œaglaonemaâ€å“ç§ï¼Œä»¥å…¶ç‹¬ç‰¹çš„å¶ç‰‡çº¹ç†å’Œè‰²å½©è€Œé—»åï¼Œå…·æœ‰å¾ˆé«˜çš„è§‚èµä»·å€¼ã€‚big-royåˆ™ä»¥å…¶å¤§è€Œå®½çš„å¶ç‰‡å¸å¼•äº†ä¼—å¤šæ¤ç‰©çˆ±å¥½è€…ï¼Œæˆä¸ºäº†å®¶å±…ç»¿åŒ–çš„çƒ­é—¨é€‰æ‹©ã€‚butterflyåˆ™å› å…¶å¶ç‰‡å½¢çŠ¶å¦‚è´è¶ç¿…è†€è€Œå¾—åï¼Œå±•ç°äº†è‡ªç„¶ç•Œçš„å¥‡å¦™é€ å‹ã€‚dona-carmenåˆ™ä»¥å…¶ä¼˜é›…çš„å¤–è§‚å’Œè‰²å½©å˜åŒ–è€Œå—åˆ°å–œçˆ±ï¼Œæˆä¸ºäº†è®¸å¤šå®¤å†…æ¤ç‰©å¸ƒç½®çš„äº®ç‚¹ã€‚

åœ¨è¿™äº›ç±»åˆ«ä¸­ï¼Œdud-anjamaniå’Œharlequinä»¥å…¶ç‹¬ç‰¹çš„æ–‘é©³è‰²å½©è€Œå¤‡å—å…³æ³¨ï¼Œå‰è€…å¸¸å¸¸å‘ˆç°å‡ºä¸°å¯Œçš„ç»¿è‰²å’Œç™½è‰²äº¤é”™ï¼Œåè€…åˆ™æ˜¯ä»¥é²œè‰³çš„çº¢è‰²å’Œç»¿è‰²ç›¸ç»“åˆï¼Œç»™äººä»¥å¼ºçƒˆçš„è§†è§‰å†²å‡»ã€‚henghengå’Œmahasetyåˆ™å±•ç°äº†ä¸åŒçš„ç”Ÿé•¿ä¹ æ€§å’Œç¯å¢ƒé€‚åº”æ€§ï¼Œå‰è€…é€‚åˆåœ¨è¾ƒä¸ºæ½®æ¹¿çš„ç¯å¢ƒä¸­ç”Ÿé•¿ï¼Œè€Œåè€…åˆ™åœ¨å¹²ç‡¥æ¡ä»¶ä¸‹è¡¨ç°å‡ºè‰¯å¥½çš„ç”Ÿå­˜èƒ½åŠ›ã€‚

red-majestyå’Œred-starduståˆ™æ˜¯â€œaglaonemaâ€ä¸­è¾ƒä¸ºç¨€æœ‰çš„å“ç§ï¼Œå‰è€…ä»¥å…¶æ·±çº¢è‰²çš„å¶ç‰‡è€Œè‘—ç§°ï¼Œåè€…åˆ™åœ¨å¶ç‰‡ä¸Šç‚¹ç¼€ç€æ˜Ÿæ˜Ÿèˆ¬çš„æ–‘ç‚¹ï¼Œå½¢æˆäº†ç‹¬ç‰¹çš„è§†è§‰æ•ˆæœã€‚striptiså’Œsuksomåˆ™æ˜¯ä»¥å…¶ç»†é•¿çš„å¶ç‰‡å’Œç‹¬ç‰¹çš„ç”Ÿé•¿å½¢æ€è€Œå—åˆ°å…³æ³¨ï¼Œé€‚åˆåœ¨é˜³å…‰å……è¶³çš„ç¯å¢ƒä¸­ç”Ÿé•¿ï¼Œå±•ç°å‡ºæå¼ºçš„ç”Ÿå‘½åŠ›ã€‚æœ€åï¼Œsweet-dreamä»¥å…¶æ¢¦å¹»èˆ¬çš„è‰²å½©ç»„åˆè€Œå—åˆ°å¹¿æ³›å–œçˆ±ï¼Œæˆä¸ºäº†è®¸å¤šæ¤ç‰©çˆ±å¥½è€…çš„å¿ƒå¤´å¥½ã€‚

é€šè¿‡å¯¹â€œaglaonemaâ€æ•°æ®é›†çš„æ·±å…¥åˆ†æï¼Œæˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿè®­ç»ƒå‡ºæ›´ä¸ºç²¾å‡†çš„YOLOv8æ¨¡å‹ï¼Œè¿˜èƒ½æå‡å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„è¯†åˆ«èƒ½åŠ›ã€‚è¿™ä¸€æ•°æ®é›†çš„æ„å»ºä¸ä½¿ç”¨ï¼Œå°†ä¸ºæ¤ç‰©ç§ç±»è¯†åˆ«æŠ€æœ¯çš„å‘å±•æä¾›é‡è¦çš„æ”¯æŒï¼Œæ¨åŠ¨ç›¸å…³é¢†åŸŸçš„ç ”ç©¶è¿›å±•ã€‚æ•°æ®é›†çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§ï¼Œç¡®ä¿äº†æ¨¡å‹åœ¨é¢å¯¹ä¸åŒç¯å¢ƒå’Œæ¡ä»¶ä¸‹çš„æ¤ç‰©è¯†åˆ«ä»»åŠ¡æ—¶ï¼Œèƒ½å¤Ÿå±•ç°å‡ºè‰¯å¥½çš„é€‚åº”æ€§å’Œå‡†ç¡®æ€§ï¼Œä¸ºæœªæ¥çš„æ¤ç‰©è¯†åˆ«ç³»ç»Ÿå¥ å®šäº†åšå®çš„åŸºç¡€ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—ç®—æ³•è‡ªé—®ä¸–ä»¥æ¥ï¼Œå‡­å€Ÿå…¶é«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›å’Œä¼˜è¶Šçš„å®æ—¶æ€§èƒ½ï¼Œè¿…é€Ÿæˆä¸ºè®¡ç®—æœºè§†è§‰é¢†åŸŸçš„çƒ­é—¨é€‰æ‹©ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼ŒYOLOç³»åˆ—ç®—æ³•ç»å†äº†å¤šä¸ªç‰ˆæœ¬çš„è¿­ä»£ï¼Œæœ€æ–°çš„YOLOv8ç‰ˆæœ¬åœ¨ç²¾åº¦å’Œé€Ÿåº¦ä¸Šå‡å®ç°äº†æ˜¾è‘—çš„æå‡ã€‚YOLOv8çš„è®¾è®¡ç†å¿µå›´ç»•ç€å¿«é€Ÿã€å‡†ç¡®å’Œæ˜“ç”¨çš„ç›®æ ‡æ£€æµ‹å±•å¼€ï¼Œé€‚ç”¨äºå„ç§å›¾åƒåˆ†å‰²å’Œåˆ†ç±»ä»»åŠ¡ã€‚

YOLOv8çš„ç½‘ç»œç»“æ„ä¸»è¦ç”±å››ä¸ªæ ¸å¿ƒéƒ¨åˆ†ç»„æˆï¼šè¾“å…¥æ¨¡å—ã€Backboneéª¨å¹²ç½‘ç»œã€Neckç‰¹å¾èåˆç½‘ç»œå’ŒHeadæ£€æµ‹æ¨¡å—ã€‚é¦–å…ˆï¼Œåœ¨è¾“å…¥æ¨¡å—ä¸­ï¼ŒYOLOv8å¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œä»¥é€‚åº”ä¸åŒçš„é•¿å®½æ¯”ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒYOLOv8å°†è¾“å…¥å›¾åƒè°ƒæ•´ä¸º640x640çš„å°ºå¯¸ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå›¾åƒçš„é•¿å®½æ¯”å¾€å¾€å„ä¸ç›¸åŒã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒYOLOv8é‡‡ç”¨è‡ªé€‚åº”å›¾åƒç¼©æ”¾æŠ€æœ¯ï¼Œå°†å›¾åƒè¾ƒé•¿çš„ä¸€è¾¹æŒ‰æ¯”ä¾‹ç¼©å°è‡³æŒ‡å®šå°ºå¯¸ï¼Œç„¶åå¯¹ç¼©å°åçš„çŸ­è¾¹è¿›è¡Œå¡«å……ã€‚è¿™ç§å¤„ç†æ–¹å¼ä¸ä»…å‡å°‘äº†å¡«å……åŒºåŸŸçš„å†—ä½™ä¿¡æ¯ï¼Œè¿˜æé«˜äº†ç›®æ ‡æ£€æµ‹çš„é€Ÿåº¦å’Œå‡†ç¡®æ€§ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥äº†Mosaicæ•°æ®å¢å¼ºæŠ€æœ¯ï¼Œé€šè¿‡éšæœºæ‹¼æ¥å››å¼ ä¸åŒçš„å›¾åƒï¼Œç”Ÿæˆæ–°çš„è®­ç»ƒæ ·æœ¬ï¼Œä»è€Œæœ‰æ•ˆæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œé¢„æµ‹ç²¾åº¦ã€‚

åœ¨Backboneéƒ¨åˆ†ï¼ŒYOLOv8çš„è®¾è®¡å€Ÿé‰´äº†YOLOv7ä¸­çš„ELANæ¨¡å—ï¼Œå°†YOLOv5ä¸­çš„C3æ¨¡å—æ›¿æ¢ä¸ºC2fæ¨¡å—ã€‚C2fæ¨¡å—é€šè¿‡å¹¶è¡Œå¤šä¸ªæ¢¯åº¦æµåˆ†æ”¯ï¼Œèƒ½å¤Ÿåœ¨ä¿æŒè½»é‡åŒ–çš„åŒæ—¶ï¼Œæå–æ›´ä¸°å¯Œçš„ç‰¹å¾ä¿¡æ¯ã€‚è¿™ç§ç»“æ„ä¼˜åŒ–ä½¿å¾—YOLOv8åœ¨ç‰¹å¾æå–çš„è¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰åˆ°ä¸åŒå°ºåº¦çš„ç›®æ ‡ä¿¡æ¯ï¼Œæå‡äº†æ¨¡å‹çš„æ£€æµ‹ç²¾åº¦ã€‚ä¸ºäº†è¿›ä¸€æ­¥å¢å¼ºç‰¹å¾å›¾çš„è¡¨è¾¾èƒ½åŠ›ï¼ŒYOLOv8è¿˜å¼•å…¥äº†SPPFï¼ˆSpatial Pyramid Pooling Fastï¼‰æ¨¡å—ï¼Œé€šè¿‡ä¸åŒå†…æ ¸å°ºå¯¸çš„æ± åŒ–æ“ä½œï¼Œå¯¹ç‰¹å¾å›¾è¿›è¡Œåˆå¹¶ï¼Œç¡®ä¿ç½‘ç»œèƒ½å¤Ÿæœ‰æ•ˆå¤„ç†å¤šå°ºåº¦ç›®æ ‡ã€‚

Neckéƒ¨åˆ†çš„è®¾è®¡åŒæ ·è‡³å…³é‡è¦ï¼ŒYOLOv8é‡‡ç”¨äº†åŒå¡”ç»“æ„ï¼Œç»“åˆäº†ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼ˆFPNï¼‰å’Œè·¯å¾„èšåˆç½‘ç»œï¼ˆPANï¼‰ã€‚è¿™ç§ç»“æ„çš„ä¼˜åŠ¿åœ¨äºï¼Œå®ƒèƒ½å¤Ÿä¿ƒè¿›è¯­ä¹‰ç‰¹å¾å’Œå®šä½ç‰¹å¾ä¹‹é—´çš„æœ‰æ•ˆè½¬ç§»ï¼Œè¿›ä¸€æ­¥å¢å¼ºç½‘ç»œå¯¹ä¸åŒå°ºåº¦ç›®æ ‡çš„æ£€æµ‹èƒ½åŠ›ã€‚é€šè¿‡ç›´æ¥å¯¹Backboneä¸åŒé˜¶æ®µè¾“å‡ºçš„ç‰¹å¾è¿›è¡Œä¸Šé‡‡æ ·æ“ä½œï¼ŒYOLOv8ç®€åŒ–äº†ç‰¹å¾èåˆçš„è¿‡ç¨‹ï¼Œä½¿å¾—ç½‘ç»œåœ¨ä¿æŒé«˜æ•ˆæ€§çš„åŒæ—¶ï¼Œèƒ½å¤Ÿè·å–æ›´ä¸°å¯Œçš„ç‰¹å¾ä¿¡æ¯ã€‚

åœ¨Headæ¨¡å—ä¸­ï¼ŒYOLOv8å®ç°äº†ä»Coupled-Headï¼ˆè€¦åˆå¤´ï¼‰åˆ°Decoupled-Headï¼ˆè§£è€¦å¤´ï¼‰çš„è½¬å˜ã€‚ä¼ ç»Ÿçš„è€¦åˆå¤´ç»“æ„å°†æ£€æµ‹å’Œåˆ†ç±»ä»»åŠ¡å…±äº«åŒä¸€å·ç§¯å±‚ï¼Œè€ŒYOLOv8åˆ™å°†è¿™ä¸¤ä¸ªä»»åŠ¡è§£è€¦ï¼Œåˆ†åˆ«ä½¿ç”¨ä¸åŒçš„å·ç§¯åˆ†æ”¯è¿›è¡Œå¤„ç†ã€‚è¿™ç§è®¾è®¡ä¸ä»…åŠ é€Ÿäº†æ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦ï¼Œè¿˜æé«˜äº†åˆ†ç±»å’Œè¾¹ç•Œæ¡†å›å½’çš„ç²¾åº¦ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨æŸå¤±å‡½æ•°çš„è®¾è®¡ä¸Šä¹Ÿè¿›è¡Œäº†åˆ›æ–°ï¼Œå–æ¶ˆäº†ä¼ ç»Ÿçš„å¯¹è±¡åˆ†æ”¯ï¼Œé‡‡ç”¨äº†æ›´ä¸ºé«˜æ•ˆçš„DFLï¼ˆDistribution Focal Lossï¼‰å’ŒCIoUï¼ˆComplete Intersection over Unionï¼‰æŸå¤±å‡½æ•°ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¿«åœ°èšç„¦äºæ ‡ç­¾é™„è¿‘çš„æ•°å€¼ï¼Œæé«˜äº†ç›®æ ‡æ£€æµ‹çš„å‡†ç¡®æ€§ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒYOLOv8åœ¨ç›®æ ‡æ£€æµ‹æ–¹æ³•ä¸Šä¹Ÿè¿›è¡Œäº†é‡è¦çš„åˆ›æ–°ï¼Œæ‘’å¼ƒäº†ä»¥å¾€çš„Anchor-Basedï¼ˆåŸºäºé”šæ¡†ï¼‰æ–¹æ³•ï¼Œè½¬è€Œé‡‡ç”¨Anchor-Freeï¼ˆæ— é”šæ¡†ï¼‰çš„æ–¹æ³•ã€‚è¿™ä¸€è½¬å˜ä½¿å¾—YOLOv8åœ¨å¤„ç†ç›®æ ‡æ£€æµ‹æ—¶ï¼Œä¸å†ä¾èµ–äºé¢„è®¾çš„é”šæ¡†ï¼Œè€Œæ˜¯å°†ç›®æ ‡æ£€æµ‹è½¬åŒ–ä¸ºå…³é”®ç‚¹æ£€æµ‹ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºï¼Œæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›æ›´å¼ºï¼Œç½‘ç»œç»“æ„æ›´ä¸ºç®€æ´ï¼Œä¸”åœ¨å¤„ç†å¤šæ ·åŒ–çš„ç›®æ ‡æ—¶ï¼Œèƒ½å¤Ÿçµæ´»åº”å¯¹ä¸åŒçš„é•¿å®½æ¯”å’Œå°ºåº¦ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒYOLOv8ç®—æ³•é€šè¿‡ä¸€ç³»åˆ—ç»“æ„ä¼˜åŒ–å’ŒæŠ€æœ¯åˆ›æ–°ï¼Œæ˜¾è‘—æå‡äº†ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ã€‚å…¶ç‹¬ç‰¹çš„è¾“å…¥å¤„ç†æ–¹å¼ã€çµæ´»çš„Backboneè®¾è®¡ã€æœ‰æ•ˆçš„ç‰¹å¾èåˆç­–ç•¥ä»¥åŠè§£è€¦çš„Headç»“æ„ï¼Œä½¿å¾—YOLOv8åœ¨å¤æ‚çš„è§†è§‰ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ã€‚å°½ç®¡åœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹ä»å­˜åœ¨ä¸€å®šçš„å±€é™æ€§ï¼Œä½†YOLOv8æ— ç–‘ä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸæä¾›äº†ä¸€ä¸ªå¼ºæœ‰åŠ›çš„å·¥å…·ï¼Œæ¨åŠ¨äº†ç›¸å…³æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ã€‚æœªæ¥ï¼Œéšç€ç®—æ³•çš„ä¸æ–­ä¼˜åŒ–å’Œåº”ç”¨åœºæ™¯çš„æ‹“å±•ï¼ŒYOLOv8æœ‰æœ›åœ¨æ›´å¤šå®é™…åº”ç”¨ä¸­å‘æŒ¥é‡è¦ä½œç”¨ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\sam\model.py

ä»¥ä¸‹æ˜¯å¯¹ç»™å®šä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œæç‚¼å’Œè¯¦ç»†æ³¨é‡Šçš„ç»“æœï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license
"""
SAMæ¨¡å‹æ¥å£ã€‚

è¯¥æ¨¡å—æä¾›äº†Ultralyticsçš„Segment Anything Model (SAM)çš„æ¥å£ï¼Œæ—¨åœ¨è¿›è¡Œå®æ—¶å›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚
SAMæ¨¡å‹å…è®¸è¿›è¡Œå¯æç¤ºçš„åˆ†å‰²ï¼Œå…·æœ‰åœ¨å›¾åƒåˆ†æä¸­çš„æ— ä¸ä¼¦æ¯”çš„å¤šåŠŸèƒ½æ€§ï¼Œå¹¶ä¸”å·²åœ¨SA-1Bæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚
å®ƒå…·æœ‰é›¶-shotæ€§èƒ½èƒ½åŠ›ï¼Œèƒ½å¤Ÿåœ¨æ²¡æœ‰å…ˆå‰çŸ¥è¯†çš„æƒ…å†µä¸‹é€‚åº”æ–°çš„å›¾åƒåˆ†å¸ƒå’Œä»»åŠ¡ã€‚
"""

from pathlib import Path
from ultralytics.engine.model import Model
from ultralytics.utils.torch_utils import model_info
from .build import build_sam
from .predict import Predictor


class SAM(Model):
    """
    SAMï¼ˆSegment Anything Modelï¼‰æ¥å£ç±»ã€‚

    SAMæ—¨åœ¨è¿›è¡Œå¯æç¤ºçš„å®æ—¶å›¾åƒåˆ†å‰²ã€‚å¯ä»¥ä½¿ç”¨å¤šç§æç¤ºï¼Œä¾‹å¦‚è¾¹ç•Œæ¡†ã€ç‚¹æˆ–æ ‡ç­¾ã€‚
    è¯¥æ¨¡å‹å…·æœ‰é›¶-shotæ€§èƒ½ï¼Œå¹¶åœ¨SA-1Bæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚
    """

    def __init__(self, model='sam_b.pt') -> None:
        """
        ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹æ–‡ä»¶åˆå§‹åŒ–SAMæ¨¡å‹ã€‚

        å‚æ•°ï¼š
            model (str): é¢„è®­ç»ƒSAMæ¨¡å‹æ–‡ä»¶çš„è·¯å¾„ã€‚æ–‡ä»¶åº”å…·æœ‰.ptæˆ–.pthæ‰©å±•åã€‚

        å¼‚å¸¸ï¼š
            NotImplementedError: å¦‚æœæ¨¡å‹æ–‡ä»¶æ‰©å±•åä¸æ˜¯.ptæˆ–.pthã€‚
        """
        # æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ‰©å±•åæ˜¯å¦æœ‰æ•ˆ
        if model and Path(model).suffix not in ('.pt', '.pth'):
            raise NotImplementedError('SAMé¢„æµ‹éœ€è¦é¢„è®­ç»ƒçš„*.ptæˆ–*.pthæ¨¡å‹ã€‚')
        super().__init__(model=model, task='segment')  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°

    def predict(self, source, stream=False, bboxes=None, points=None, labels=None, **kwargs):
        """
        å¯¹ç»™å®šçš„å›¾åƒæˆ–è§†é¢‘æºæ‰§è¡Œåˆ†å‰²é¢„æµ‹ã€‚

        å‚æ•°ï¼š
            source (str): å›¾åƒæˆ–è§†é¢‘æ–‡ä»¶çš„è·¯å¾„ï¼Œæˆ–PIL.Imageå¯¹è±¡ï¼Œæˆ–numpy.ndarrayå¯¹è±¡ã€‚
            stream (bool, optional): å¦‚æœä¸ºTrueï¼Œåˆ™å¯ç”¨å®æ—¶æµã€‚é»˜è®¤ä¸ºFalseã€‚
            bboxes (list, optional): æç¤ºåˆ†å‰²çš„è¾¹ç•Œæ¡†åæ ‡åˆ—è¡¨ã€‚é»˜è®¤ä¸ºNoneã€‚
            points (list, optional): æç¤ºåˆ†å‰²çš„ç‚¹åˆ—è¡¨ã€‚é»˜è®¤ä¸ºNoneã€‚
            labels (list, optional): æç¤ºåˆ†å‰²çš„æ ‡ç­¾åˆ—è¡¨ã€‚é»˜è®¤ä¸ºNoneã€‚

        è¿”å›ï¼š
            (list): æ¨¡å‹é¢„æµ‹ç»“æœã€‚
        """
        # è®¾ç½®é¢„æµ‹çš„è¦†ç›–å‚æ•°
        overrides = dict(conf=0.25, task='segment', mode='predict', imgsz=1024)
        kwargs.update(overrides)  # æ›´æ–°å‚æ•°
        prompts = dict(bboxes=bboxes, points=points, labels=labels)  # æ”¶é›†æç¤ºä¿¡æ¯
        return super().predict(source, stream, prompts=prompts, **kwargs)  # è°ƒç”¨çˆ¶ç±»çš„é¢„æµ‹æ–¹æ³•

    def info(self, detailed=False, verbose=True):
        """
        è®°å½•æœ‰å…³SAMæ¨¡å‹çš„ä¿¡æ¯ã€‚

        å‚æ•°ï¼š
            detailed (bool, optional): å¦‚æœä¸ºTrueï¼Œåˆ™æ˜¾ç¤ºæœ‰å…³æ¨¡å‹çš„è¯¦ç»†ä¿¡æ¯ã€‚é»˜è®¤ä¸ºFalseã€‚
            verbose (bool, optional): å¦‚æœä¸ºTrueï¼Œåˆ™åœ¨æ§åˆ¶å°ä¸Šæ˜¾ç¤ºä¿¡æ¯ã€‚é»˜è®¤ä¸ºTrueã€‚

        è¿”å›ï¼š
            (tuple): åŒ…å«æ¨¡å‹ä¿¡æ¯çš„å…ƒç»„ã€‚
        """
        return model_info(self.model, detailed=detailed, verbose=verbose)  # è·å–æ¨¡å‹ä¿¡æ¯

    @property
    def task_map(self):
        """
        æä¾›ä»â€œsegmentâ€ä»»åŠ¡åˆ°å…¶å¯¹åº”çš„â€œPredictorâ€çš„æ˜ å°„ã€‚

        è¿”å›ï¼š
            (dict): å°†â€œsegmentâ€ä»»åŠ¡æ˜ å°„åˆ°å…¶å¯¹åº”çš„â€œPredictorâ€çš„å­—å…¸ã€‚
        """
        return {'segment': {'predictor': Predictor}}  # è¿”å›ä»»åŠ¡æ˜ å°„
```

### æ ¸å¿ƒéƒ¨åˆ†åˆ†æ
1. **ç±»å®šä¹‰**ï¼š`SAM`ç±»ç»§æ‰¿è‡ª`Model`ï¼Œæä¾›äº†å›¾åƒåˆ†å‰²çš„åŠŸèƒ½ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__`æ–¹æ³•è´Ÿè´£åŠ è½½é¢„è®­ç»ƒæ¨¡å‹ï¼Œå¹¶ç¡®ä¿æ¨¡å‹æ–‡ä»¶çš„æœ‰æ•ˆæ€§ã€‚
3. **é¢„æµ‹æ–¹æ³•**ï¼š`predict`æ–¹æ³•æ‰§è¡Œå›¾åƒåˆ†å‰²é¢„æµ‹ï¼Œæ”¯æŒå¤šç§è¾“å…¥æ ¼å¼å’Œæç¤ºæ–¹å¼ã€‚
4. **ä¿¡æ¯è·å–**ï¼š`info`æ–¹æ³•ç”¨äºè·å–å’Œè®°å½•æ¨¡å‹çš„ç›¸å…³ä¿¡æ¯ã€‚
5. **ä»»åŠ¡æ˜ å°„**ï¼š`task_map`å±æ€§æä¾›äº†ä»»åŠ¡ä¸é¢„æµ‹å™¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚

è¿™äº›éƒ¨åˆ†æ„æˆäº†SAMæ¨¡å‹çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ”¯æŒå®æ—¶å›¾åƒåˆ†å‰²å’Œå¤šç§è¾“å…¥æç¤ºæ–¹å¼ã€‚

è¯¥æ–‡ä»¶æ˜¯Ultralytics YOLOæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œä¸»è¦ç”¨äºå®ç°Segment Anything Modelï¼ˆSAMï¼‰çš„æ¥å£ã€‚SAMæ¨¡å‹ä¸“é—¨è®¾è®¡ç”¨äºå®æ—¶å›¾åƒåˆ†å‰²ä»»åŠ¡ï¼Œå…·æœ‰æé«˜çš„çµæ´»æ€§ï¼Œèƒ½å¤Ÿæ ¹æ®ä¸åŒçš„æç¤ºè¿›è¡Œåˆ†å‰²ï¼Œå¹¶ä¸”å…·å¤‡é›¶-shotæ€§èƒ½ï¼Œå¯ä»¥åœ¨æ²¡æœ‰å…ˆå‰çŸ¥è¯†çš„æƒ…å†µä¸‹é€‚åº”æ–°çš„å›¾åƒåˆ†å¸ƒå’Œä»»åŠ¡ã€‚è¯¥æ¨¡å‹ç»è¿‡SA-1Bæ•°æ®é›†çš„è®­ç»ƒï¼Œæ”¯æŒå¤šç§æç¤ºæ–¹å¼ï¼Œå¦‚è¾¹ç•Œæ¡†ã€ç‚¹æˆ–æ ‡ç­¾ã€‚

åœ¨æ–‡ä»¶ä¸­ï¼Œé¦–å…ˆå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„åº“å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬`Path`ç”¨äºå¤„ç†æ–‡ä»¶è·¯å¾„ï¼Œ`Model`ç±»ç”¨äºç»§æ‰¿ï¼Œ`model_info`ç”¨äºè·å–æ¨¡å‹ä¿¡æ¯ï¼Œä»¥åŠ`build_sam`å’Œ`Predictor`ç”¨äºæ„å»ºæ¨¡å‹å’Œè¿›è¡Œé¢„æµ‹ã€‚

æ¥ä¸‹æ¥å®šä¹‰äº†ä¸€ä¸ªåä¸º`SAM`çš„ç±»ï¼Œç»§æ‰¿è‡ª`Model`ç±»ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°`__init__`æ¥å—ä¸€ä¸ªæ¨¡å‹æ–‡ä»¶è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå¹¶æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦ä¸º`.pt`æˆ–`.pth`ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™æŠ›å‡º`NotImplementedError`å¼‚å¸¸ã€‚ç„¶åè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ã€‚

`_load`æ–¹æ³•ç”¨äºåŠ è½½æŒ‡å®šçš„æƒé‡æ–‡ä»¶åˆ°SAMæ¨¡å‹ä¸­ï¼Œæ¥å—æƒé‡æ–‡ä»¶è·¯å¾„å’Œä»»åŠ¡åç§°ä½œä¸ºå‚æ•°ã€‚

`predict`æ–¹æ³•æ˜¯è¯¥ç±»çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œè´Ÿè´£å¯¹ç»™å®šçš„å›¾åƒæˆ–è§†é¢‘æºè¿›è¡Œåˆ†å‰²é¢„æµ‹ã€‚å®ƒæ¥å—å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬æºæ–‡ä»¶è·¯å¾„ã€æ˜¯å¦å¯ç”¨å®æ—¶æµã€è¾¹ç•Œæ¡†ã€ç‚¹å’Œæ ‡ç­¾ç­‰ã€‚è¯¥æ–¹æ³•ä¼šå°†ä¸€äº›é»˜è®¤å‚æ•°ä¸ç”¨æˆ·æä¾›çš„å‚æ•°åˆå¹¶ï¼Œå¹¶è°ƒç”¨çˆ¶ç±»çš„`predict`æ–¹æ³•è¿›è¡Œå®é™…çš„é¢„æµ‹ã€‚

`__call__`æ–¹æ³•æ˜¯`predict`æ–¹æ³•çš„åˆ«åï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è°ƒç”¨å®ä¾‹å¯¹è±¡æ¥è¿›è¡Œé¢„æµ‹ï¼Œä½¿ç”¨æ–¹å¼ä¸`predict`æ–¹æ³•ç›¸åŒã€‚

`info`æ–¹æ³•ç”¨äºè®°å½•å’Œè¿”å›å…³äºSAMæ¨¡å‹çš„ä¿¡æ¯ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©æ˜¯å¦è·å–è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶å†³å®šæ˜¯å¦åœ¨æ§åˆ¶å°ä¸Šæ˜¾ç¤ºä¿¡æ¯ã€‚

æœ€åï¼Œ`task_map`å±æ€§æä¾›äº†ä¸€ä¸ªä»â€œsegmentâ€ä»»åŠ¡åˆ°å…¶å¯¹åº”çš„â€œPredictorâ€çš„æ˜ å°„ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸ï¼Œä¾¿äºåœ¨æ‰§è¡Œåˆ†å‰²ä»»åŠ¡æ—¶è¿›è¡Œç›¸åº”çš„é¢„æµ‹ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ–‡ä»¶å®ç°äº†SAMæ¨¡å‹çš„åŸºæœ¬åŠŸèƒ½å’Œæ¥å£ï¼Œä¾¿äºç”¨æˆ·è¿›è¡Œå›¾åƒåˆ†å‰²ä»»åŠ¡çš„æ“ä½œå’Œæ¨¡å‹ä¿¡æ¯çš„è·å–ã€‚

#### 11.2 70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\extra_modules\block.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼Œä¿ç•™äº†æœ€é‡è¦çš„åŠŸèƒ½å’Œç»“æ„ï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

# è‡ªé€‚åº”å¡«å……å‡½æ•°ï¼Œç¡®ä¿è¾“å‡ºå½¢çŠ¶ä¸è¾“å…¥ç›¸åŒ
def autopad(k, p=None, d=1):
    """æ ¹æ®å·ç§¯æ ¸å¤§å°å’Œè†¨èƒ€ç‡è‡ªåŠ¨è®¡ç®—å¡«å……å¤§å°"""
    if d > 1:
        k = d * (k - 1) + 1 if isinstance(k, int) else [d * (x - 1) + 1 for x in k]  # å®é™…çš„å·ç§¯æ ¸å¤§å°
    if p is None:
        p = k // 2 if isinstance(k, int) else [x // 2 for x in k]  # è‡ªåŠ¨å¡«å……
    return p

# å®šä¹‰Swishæ¿€æ´»å‡½æ•°
class swish(nn.Module):
    def forward(self, x):
        return x * torch.sigmoid(x)

# å®šä¹‰å¸¦æœ‰HSigmoidæ¿€æ´»å‡½æ•°çš„æ¨¡å—
class h_sigmoid(nn.Module):
    def __init__(self, inplace=True):
        super(h_sigmoid, self).__init__()
        self.relu = nn.ReLU6(inplace=inplace)

    def forward(self, x):
        return self.relu(x + 3) / 6

# å®šä¹‰åŠ¨æ€ReLUæ¨¡å—
class DyReLU(nn.Module):
    def __init__(self, inp, reduction=4):
        super(DyReLU, self).__init__()
        self.oup = inp
        squeeze = inp // reduction  # ç¡®å®šå‹ç¼©æ¯”
        self.fc = nn.Sequential(
            nn.Linear(inp, squeeze),
            nn.ReLU(inplace=True),
            nn.Linear(squeeze, self.oup * 2),  # è¾“å‡ºä¸¤ä¸ªé€šé“
            h_sigmoid()
        )

    def forward(self, x):
        b, c, h, w = x.size()
        y = self.fc(x.mean(dim=[2, 3])).view(b, self.oup * 2, 1, 1)  # å…¨å±€å¹³å‡æ± åŒ–
        a1, b1 = torch.split(y, self.oup, dim=1)  # åˆ†å‰²ä¸ºä¸¤ä¸ªé€šé“
        out = x * a1 + b1  # åº”ç”¨åŠ¨æ€ReLU
        return out

# å®šä¹‰å¸¦æœ‰åŠ¨æ€å·ç§¯çš„æ¨¡å—
class DyDCNv2(nn.Module):
    def __init__(self, in_channels, out_channels):
        super().__init__()
        self.conv = nn.Conv2d(in_channels, out_channels, kernel_size=3, padding=1)
        self.norm = nn.BatchNorm2d(out_channels)

    def forward(self, x):
        x = self.conv(x)
        x = self.norm(x)
        return x

# å®šä¹‰DyHeadBlockæ¨¡å—ï¼ŒåŒ…å«åŠ¨æ€å·ç§¯å’Œæ³¨æ„åŠ›æœºåˆ¶
class DyHeadBlock(nn.Module):
    def __init__(self, in_channels):
        super().__init__()
        self.spatial_conv = DyDCNv2(in_channels, in_channels)
        self.task_attn_module = DyReLU(in_channels)

    def forward(self, x):
        mid_feat = self.spatial_conv(x)
        out = self.task_attn_module(mid_feat)
        return out

# å®šä¹‰èåˆæ¨¡å—
class Fusion(nn.Module):
    def __init__(self, inc_list):
        super().__init__()
        self.fusion_conv = nn.ModuleList([nn.Conv2d(inc, inc, 1) for inc in inc_list])

    def forward(self, x):
        for i in range(len(x)):
            x[i] = self.fusion_conv[i](x[i])
        return torch.cat(x, dim=1)  # å°†æ‰€æœ‰ç‰¹å¾å›¾æ‹¼æ¥åœ¨ä¸€èµ·

# å®šä¹‰åŸºæœ¬çš„å·ç§¯å—
class Conv(nn.Module):
    def __init__(self, in_channels, out_channels, kernel_size, stride=1, padding=0):
        super().__init__()
        self.conv = nn.Conv2d(in_channels, out_channels, kernel_size, stride, padding)

    def forward(self, x):
        return self.conv(x)

# å®šä¹‰ä¸»ç½‘ç»œç»“æ„
class MainNet(nn.Module):
    def __init__(self, num_classes):
        super().__init__()
        self.conv1 = Conv(3, 32, 3, padding=1)
        self.dy_head = DyHeadBlock(32)
        self.fusion = Fusion([32, 32])

    def forward(self, x):
        x = self.conv1(x)
        x = self.dy_head(x)
        x = self.fusion([x, x])  # è¿›è¡Œç‰¹å¾èåˆ
        return x

# å®ä¾‹åŒ–ç½‘ç»œ
model = MainNet(num_classes=10)
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **autopad**: è‡ªåŠ¨è®¡ç®—å·ç§¯çš„å¡«å……å¤§å°ï¼Œä»¥ç¡®ä¿è¾“å‡ºå½¢çŠ¶ä¸è¾“å…¥å½¢çŠ¶ç›¸åŒã€‚
2. **swish**: å®šä¹‰Swishæ¿€æ´»å‡½æ•°ã€‚
3. **h_sigmoid**: å®šä¹‰å¸¦æœ‰HSigmoidæ¿€æ´»å‡½æ•°çš„æ¨¡å—ã€‚
4. **DyReLU**: åŠ¨æ€ReLUæ¨¡å—ï¼Œæ ¹æ®è¾“å…¥çš„ç‰¹å¾å›¾åŠ¨æ€è°ƒæ•´è¾“å‡ºã€‚
5. **DyDCNv2**: å¸¦æœ‰åŠ¨æ€å·ç§¯çš„æ¨¡å—ï¼Œä½¿ç”¨å·ç§¯å’Œå½’ä¸€åŒ–å±‚ã€‚
6. **DyHeadBlock**: ä¸»è¦çš„å¤´éƒ¨æ¨¡å—ï¼Œç»“åˆåŠ¨æ€å·ç§¯å’Œæ³¨æ„åŠ›æœºåˆ¶ã€‚
7. **Fusion**: èåˆæ¨¡å—ï¼Œå°†å¤šä¸ªè¾“å…¥ç‰¹å¾å›¾è¿›è¡Œèåˆã€‚
8. **Conv**: åŸºæœ¬çš„å·ç§¯å—ã€‚
9. **MainNet**: ä¸»ç½‘ç»œç»“æ„ï¼ŒåŒ…å«åˆå§‹å·ç§¯å±‚ã€åŠ¨æ€å¤´éƒ¨å’Œèåˆæ¨¡å—ã€‚

è¿™ä¸ªç®€åŒ–ç‰ˆæœ¬ä¿ç•™äº†æ ¸å¿ƒç»“æ„å’ŒåŠŸèƒ½ï¼ŒåŒæ—¶æä¾›äº†è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼Œä¾¿äºç†è§£æ¯ä¸ªéƒ¨åˆ†çš„ä½œç”¨ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªå…³äºYOLOv8ç®—æ³•æ”¹è¿›çš„æ·±åº¦å­¦ä¹ æ¨¡å‹çš„å®ç°ï¼Œä¸»è¦æ¶‰åŠäº†å¤šç§æ¨¡å—å’Œå±‚çš„å®šä¹‰ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†è®¸å¤šä¸åŒçš„ç¥ç»ç½‘ç»œç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥ç»„åˆåœ¨ä¸€èµ·ä»¥æ„å»ºå¤æ‚çš„ç½‘ç»œç»“æ„ã€‚ä»¥ä¸‹æ˜¯å¯¹æ–‡ä»¶å†…å®¹çš„é€æ­¥è§£æã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬PyTorchã€NumPyå’Œä¸€äº›è‡ªå®šä¹‰æ¨¡å—ã€‚è¿™äº›åº“æä¾›äº†æ„å»ºå’Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹æ‰€éœ€çš„åŸºæœ¬åŠŸèƒ½ã€‚

æ¥ä¸‹æ¥ï¼Œæ–‡ä»¶å®šä¹‰äº†ä¸€ç³»åˆ—çš„ç¥ç»ç½‘ç»œæ¨¡å—ï¼ŒåŒ…æ‹¬å·ç§¯å±‚ã€æ³¨æ„åŠ›æœºåˆ¶ã€æ®‹å·®å—ç­‰ã€‚è¿™äº›æ¨¡å—å¯ä»¥é€šè¿‡ç»„åˆä½¿ç”¨æ¥å®ç°ä¸åŒçš„ç½‘ç»œæ¶æ„ã€‚ä¾‹å¦‚ï¼Œ`Bottleneck`ç±»æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ç“¶é¢ˆç»“æ„ï¼Œé€šå¸¸ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹ä¸­ä»¥å‡å°‘å‚æ•°æ•°é‡å’Œè®¡ç®—é‡ã€‚

æ–‡ä»¶ä¸­è¿˜å®šä¹‰äº†å¤šç§æ”¹è¿›çš„å·ç§¯å±‚ï¼Œå¦‚`GhostConv`ã€`RepConv`å’Œ`DWConv`ï¼Œè¿™äº›å±‚é€šè¿‡ä¸åŒçš„æ–¹å¼ä¼˜åŒ–äº†è®¡ç®—æ•ˆç‡å’Œæ¨¡å‹æ€§èƒ½ã€‚`GhostConv`æ˜¯é€šè¿‡ç”Ÿæˆæ›´å°‘çš„ç‰¹å¾å›¾æ¥å‡å°‘è®¡ç®—é‡ï¼Œè€Œ`RepConv`åˆ™é€šè¿‡ä½¿ç”¨å¯é‡å‚æ•°åŒ–çš„å·ç§¯æ¥æé«˜çµæ´»æ€§ã€‚

æ³¨æ„åŠ›æœºåˆ¶åœ¨æ–‡ä»¶ä¸­ä¹Ÿå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼Œä¾‹å¦‚`DyHeadBlock`å’Œ`FocusedLinearAttention`ç±»ï¼Œè¿™äº›ç±»é€šè¿‡å¼•å…¥æ³¨æ„åŠ›æœºåˆ¶æ¥å¢å¼ºæ¨¡å‹å¯¹é‡è¦ç‰¹å¾çš„å…³æ³¨ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚

æ­¤å¤–ï¼Œæ–‡ä»¶ä¸­è¿˜å®ç°äº†ä¸€äº›ç‰¹å®šçš„æ¨¡å—ï¼Œå¦‚`FocalModulation`å’Œ`ContextGuidedBlock`ï¼Œè¿™äº›æ¨¡å—é€šè¿‡ä¸åŒçš„æ–¹å¼æ¥å¢å¼ºç‰¹å¾æå–å’Œä¿¡æ¯èåˆçš„èƒ½åŠ›ã€‚

åœ¨å®ç°ç»†èŠ‚ä¸Šï¼Œæ–‡ä»¶ä½¿ç”¨äº†è®¸å¤šPyTorchçš„ç‰¹æ€§ï¼Œå¦‚è‡ªå®šä¹‰çš„å‰å‘ä¼ æ’­æ–¹æ³•ã€æ¨¡å—çš„ç»„åˆå’Œå‚æ•°çš„åˆå§‹åŒ–ç­‰ã€‚é€šè¿‡è¿™äº›å®ç°ï¼Œæ–‡ä»¶å±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªå¤æ‚çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œç‰¹åˆ«æ˜¯é’ˆå¯¹ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„YOLOv8æ¨¡å‹ã€‚

æœ€åï¼Œæ–‡ä»¶è¿˜åŒ…å«äº†ä¸€äº›ç”¨äºæ¨¡å‹è®­ç»ƒå’Œæ¨ç†çš„å®ç”¨åŠŸèƒ½ï¼Œå¦‚è‡ªé€‚åº”å¹³å‡æ± åŒ–ã€DropPathç­‰ï¼Œè¿™äº›åŠŸèƒ½å¯ä»¥å¸®åŠ©æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ›´å¥½åœ°å­¦ä¹ å’Œæ³›åŒ–ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶æä¾›äº†ä¸€ä¸ªå…¨é¢çš„YOLOv8ç®—æ³•æ”¹è¿›çš„å®ç°ï¼Œæ¶µç›–äº†ä»åŸºç¡€å·ç§¯å±‚åˆ°å¤æ‚çš„æ³¨æ„åŠ›æœºåˆ¶å’Œç‰¹å¾èåˆæ¨¡å—çš„å¤šç§ç»„ä»¶ï¼Œé€‚åˆç”¨äºç›®æ ‡æ£€æµ‹ç­‰è®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚

#### 11.3 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ streamlit è¿è¡ŒæŒ‡å®šçš„è„šæœ¬
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤
    result = subprocess.run(command, shell=True)
    # æ£€æŸ¥å‘½ä»¤æ‰§è¡Œç»“æœï¼Œå¦‚æœè¿”å›ç ä¸ä¸º0ï¼Œè¡¨ç¤ºæ‰§è¡Œå‡ºé”™
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")

# å®ä¾‹åŒ–å¹¶è¿è¡Œåº”ç”¨
if __name__ == "__main__":
    # æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # å‡è®¾è„šæœ¬åœ¨å½“å‰ç›®å½•ä¸‹

    # è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åŠæ³¨é‡Š

1. **å¯¼å…¥æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **`run_script` å‡½æ•°**ï¼š
   - **å‚æ•°**ï¼šæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚
   - **è·å– Python è§£é‡Šå™¨è·¯å¾„**ï¼šä½¿ç”¨ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„å®Œæ•´è·¯å¾„ã€‚
   - **æ„å»ºå‘½ä»¤**ï¼šä½¿ç”¨ f-string æ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œæ ¼å¼ä¸º `"{python_path}" -m streamlit run "{script_path}"`ï¼Œç”¨äºé€šè¿‡ `streamlit` è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚
   - **æ‰§è¡Œå‘½ä»¤**ï¼šä½¿ç”¨ `subprocess.run` æ‰§è¡Œæ„å»ºçš„å‘½ä»¤ï¼Œ`shell=True` è¡¨ç¤ºåœ¨ shell ä¸­æ‰§è¡Œå‘½ä»¤ã€‚
   - **æ£€æŸ¥æ‰§è¡Œç»“æœ**ï¼šé€šè¿‡ `result.returncode` æ£€æŸ¥å‘½ä»¤çš„è¿”å›ç ï¼Œå¦‚æœä¸ä¸º0ï¼Œè¡¨ç¤ºæ‰§è¡Œå‡ºé”™ï¼Œæ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

3. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - `if __name__ == "__main__":` ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥è„šæœ¬æ—¶æ‰ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚
   - **æŒ‡å®šè„šæœ¬è·¯å¾„**ï¼šå‡è®¾è¦è¿è¡Œçš„è„šæœ¬ä¸º `web.py`ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹è·¯å¾„ã€‚
   - **è°ƒç”¨ `run_script` å‡½æ•°**ï¼šä¼ å…¥è„šæœ¬è·¯å¾„ï¼Œæ‰§è¡Œè¯¥è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶åä¸º `ui.py`ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒæ¥è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„æ–‡ä»¶ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œè¿™äº›æ¨¡å—åˆ†åˆ«ç”¨äºè·å–ç³»ç»Ÿä¿¡æ¯ã€æ“ä½œç³»ç»ŸåŠŸèƒ½å’Œæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªå‚æ•° `script_path`ï¼Œç”¨äºæ¥æ”¶è¦è¿è¡Œçš„è„šæœ¬çš„è·¯å¾„ã€‚å‡½æ•°å†…éƒ¨é€šè¿‡ `sys.executable` è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œç„¶åæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¯¥å‘½ä»¤ç”¨äºè¿è¡Œ Streamlit åº”ç”¨ã€‚å‘½ä»¤çš„æ ¼å¼æ˜¯ `"{python_path}" -m streamlit run "{script_path}"`ï¼Œå…¶ä¸­ `python_path` æ˜¯ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œ`script_path` æ˜¯ä¼ å…¥çš„è„šæœ¬è·¯å¾„ã€‚

æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ `subprocess.run` æ–¹æ³•æ‰§è¡Œæ„å»ºå¥½çš„å‘½ä»¤ã€‚è¯¥æ–¹æ³•çš„ `shell=True` å‚æ•°å…è®¸åœ¨ shell ä¸­æ‰§è¡Œå‘½ä»¤ã€‚æ‰§è¡Œåï¼Œç¨‹åºä¼šæ£€æŸ¥è¿”å›çš„ç»“æœä»£ç ï¼Œå¦‚æœè¿”å›å€¼ä¸ä¸º 0ï¼Œè¡¨ç¤ºè„šæœ¬è¿è¡Œå‡ºé”™ï¼Œç¨‹åºä¼šæ‰“å°å‡ºé”™è¯¯ä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥æ–‡ä»¶æ—¶æ‰ä¼šæ‰§è¡Œåé¢çš„ä»£ç ã€‚æ­¤å¤„æŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ä¸º `web.py`ï¼Œå¹¶è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚

æ€»ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç¨‹åºçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°é€šè¿‡å½“å‰ Python ç¯å¢ƒæ¥å¯åŠ¨ä¸€ä¸ª Streamlit åº”ç”¨ï¼Œæä¾›äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥è¿è¡Œå’Œè°ƒè¯• Web åº”ç”¨ã€‚

#### 11.4 code\ultralytics\models\yolo\segment\val.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
class SegmentationValidator(DetectionValidator):
    """
    æ‰©å±•è‡ª DetectionValidator ç±»çš„åˆ†å‰²éªŒè¯å™¨ï¼Œç”¨äºåŸºäºåˆ†å‰²æ¨¡å‹çš„éªŒè¯ã€‚
    """

    def __init__(self, dataloader=None, save_dir=None, pbar=None, args=None, _callbacks=None):
        """åˆå§‹åŒ– SegmentationValidatorï¼Œè®¾ç½®ä»»åŠ¡ä¸º 'segment'ï¼Œå¹¶åˆå§‹åŒ–æŒ‡æ ‡ä¸º SegmentMetricsã€‚"""
        super().__init__(dataloader, save_dir, pbar, args, _callbacks)
        self.plot_masks = None  # ç”¨äºå­˜å‚¨ç»˜åˆ¶çš„æ©ç 
        self.process = None  # æ©ç å¤„ç†å‡½æ•°
        self.args.task = "segment"  # è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºåˆ†å‰²
        self.metrics = SegmentMetrics(save_dir=self.save_dir, on_plot=self.on_plot)  # åˆå§‹åŒ–æŒ‡æ ‡

    def preprocess(self, batch):
        """é¢„å¤„ç†æ‰¹æ¬¡ï¼Œå°†æ©ç è½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶å‘é€åˆ°è®¾å¤‡ã€‚"""
        batch = super().preprocess(batch)  # è°ƒç”¨çˆ¶ç±»çš„é¢„å¤„ç†æ–¹æ³•
        batch["masks"] = batch["masks"].to(self.device).float()  # å°†æ©ç è½¬ç§»åˆ°è®¾å¤‡å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°
        return batch

    def postprocess(self, preds):
        """åå¤„ç† YOLO é¢„æµ‹ï¼Œè¿”å›è¾“å‡ºæ£€æµ‹ç»“æœå’ŒåŸå‹ã€‚"""
        p = ops.non_max_suppression(
            preds[0],
            self.args.conf,
            self.args.iou,
            labels=self.lb,
            multi_label=True,
            agnostic=self.args.single_cls,
            max_det=self.args.max_det,
            nc=self.nc,
        )  # åº”ç”¨éæå¤§å€¼æŠ‘åˆ¶
        proto = preds[1][-1] if len(preds[1]) == 3 else preds[1]  # è·å–åŸå‹
        return p, proto  # è¿”å›å¤„ç†åçš„é¢„æµ‹å’ŒåŸå‹

    def update_metrics(self, preds, batch):
        """æ›´æ–°æŒ‡æ ‡ï¼Œè®¡ç®—çœŸé˜³æ€§ã€é¢„æµ‹ç±»åˆ«ç­‰ã€‚"""
        for si, (pred, proto) in enumerate(zip(preds[0], preds[1])):
            self.seen += 1  # è®°å½•å·²å¤„ç†çš„æ ·æœ¬æ•°é‡
            npr = len(pred)  # å½“å‰é¢„æµ‹çš„æ•°é‡
            stat = dict(
                conf=torch.zeros(0, device=self.device),
                pred_cls=torch.zeros(0, device=self.device),
                tp=torch.zeros(npr, self.niou, dtype=torch.bool, device=self.device),
                tp_m=torch.zeros(npr, self.niou, dtype=torch.bool, device=self.device),
            )  # åˆå§‹åŒ–ç»Ÿè®¡ä¿¡æ¯
            pbatch = self._prepare_batch(si, batch)  # å‡†å¤‡å½“å‰æ‰¹æ¬¡
            cls, bbox = pbatch.pop("cls"), pbatch.pop("bbox")  # è·å–ç±»åˆ«å’Œè¾¹ç•Œæ¡†
            nl = len(cls)  # ç›®æ ‡æ•°é‡
            stat["target_cls"] = cls  # è®°å½•ç›®æ ‡ç±»åˆ«
            if npr == 0:  # å¦‚æœæ²¡æœ‰é¢„æµ‹
                if nl:
                    for k in self.stats.keys():
                        self.stats[k].append(stat[k])  # æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                continue

            # å¤„ç†æ©ç 
            gt_masks = pbatch.pop("masks")  # è·å–çœŸå®æ©ç 
            predn, pred_masks = self._prepare_pred(pred, pbatch, proto)  # å‡†å¤‡é¢„æµ‹ç»“æœå’Œæ©ç 
            stat["conf"] = predn[:, 4]  # è®°å½•ç½®ä¿¡åº¦
            stat["pred_cls"] = predn[:, 5]  # è®°å½•é¢„æµ‹ç±»åˆ«

            # è¯„ä¼°
            if nl:
                stat["tp"] = self._process_batch(predn, bbox, cls)  # å¤„ç†è¾¹ç•Œæ¡†
                stat["tp_m"] = self._process_batch(
                    predn, bbox, cls, pred_masks, gt_masks, self.args.overlap_mask, masks=True
                )  # å¤„ç†æ©ç 
            for k in self.stats.keys():
                self.stats[k].append(stat[k])  # æ›´æ–°ç»Ÿè®¡ä¿¡æ¯

    def _process_batch(self, detections, gt_bboxes, gt_cls, pred_masks=None, gt_masks=None, overlap=False, masks=False):
        """
        è¿”å›æ­£ç¡®çš„é¢„æµ‹çŸ©é˜µã€‚

        å‚æ•°:
            detections (array[N, 6]), x1, y1, x2, y2, conf, class
            labels (array[M, 5]), class, x1, y1, x2, y2

        è¿”å›:
            correct (array[N, 10]), å¯¹äº 10 ä¸ª IoU æ°´å¹³
        """
        if masks:
            # å¤„ç†æ©ç çš„æƒ…å†µ
            if overlap:
                nl = len(gt_cls)
                index = torch.arange(nl, device=gt_masks.device).view(nl, 1, 1) + 1
                gt_masks = gt_masks.repeat(nl, 1, 1)  # æ‰©å±•æ©ç 
                gt_masks = torch.where(gt_masks == index, 1.0, 0.0)  # åˆ›å»ºæ©ç 
            if gt_masks.shape[1:] != pred_masks.shape[1:]:
                gt_masks = F.interpolate(gt_masks[None], pred_masks.shape[1:], mode="bilinear", align_corners=False)[0]
                gt_masks = gt_masks.gt_(0.5)  # è¿›è¡Œé˜ˆå€¼å¤„ç†
            iou = mask_iou(gt_masks.view(gt_masks.shape[0], -1), pred_masks.view(pred_masks.shape[0], -1))  # è®¡ç®—æ©ç çš„ IoU
        else:  # å¤„ç†è¾¹ç•Œæ¡†çš„æƒ…å†µ
            iou = box_iou(gt_bboxes, detections[:, :4])  # è®¡ç®—è¾¹ç•Œæ¡†çš„ IoU

        return self.match_predictions(detections[:, 5], gt_cls, iou)  # åŒ¹é…é¢„æµ‹ä¸çœŸå®æ ‡ç­¾

    def eval_json(self, stats):
        """è¿”å› COCO é£æ ¼çš„ç›®æ ‡æ£€æµ‹è¯„ä¼°æŒ‡æ ‡ã€‚"""
        if self.args.save_json and self.is_coco and len(self.jdict):
            anno_json = self.data["path"] / "annotations/instances_val2017.json"  # æ³¨é‡Šæ–‡ä»¶è·¯å¾„
            pred_json = self.save_dir / "predictions.json"  # é¢„æµ‹ç»“æœæ–‡ä»¶è·¯å¾„
            LOGGER.info(f"\nEvaluating pycocotools mAP using {pred_json} and {anno_json}...")
            try:
                check_requirements("pycocotools>=2.0.6")  # æ£€æŸ¥ä¾èµ–
                from pycocotools.coco import COCO  # å¯¼å…¥ COCO API
                from pycocotools.cocoeval import COCOeval  # å¯¼å…¥ COCO è¯„ä¼°ç±»

                for x in anno_json, pred_json:
                    assert x.is_file(), f"{x} file not found"  # ç¡®ä¿æ–‡ä»¶å­˜åœ¨
                anno = COCO(str(anno_json))  # åˆå§‹åŒ–æ³¨é‡Š API
                pred = anno.loadRes(str(pred_json))  # åˆå§‹åŒ–é¢„æµ‹ API
                for i, eval in enumerate([COCOeval(anno, pred, "bbox"), COCOeval(anno, pred, "segm")]):
                    if self.is_coco:
                        eval.params.imgIds = [int(Path(x).stem) for x in self.dataloader.dataset.im_files]  # è®¾ç½®è¯„ä¼°çš„å›¾åƒ ID
                    eval.evaluate()  # è¯„ä¼°
                    eval.accumulate()  # ç´¯è®¡ç»“æœ
                    eval.summarize()  # æ€»ç»“ç»“æœ
                    idx = i * 4 + 2
                    stats[self.metrics.keys[idx + 1]], stats[self.metrics.keys[idx]] = eval.stats[:2]  # æ›´æ–° mAP50-95 å’Œ mAP50
            except Exception as e:
                LOGGER.warning(f"pycocotools unable to run: {e}")  # æ•è·å¼‚å¸¸å¹¶è®°å½•è­¦å‘Š
        return stats  # è¿”å›ç»Ÿè®¡ä¿¡æ¯
```

ä»¥ä¸Šä»£ç æ˜¯ YOLO åˆ†å‰²æ¨¡å‹éªŒè¯çš„æ ¸å¿ƒéƒ¨åˆ†ï¼ŒåŒ…å«äº†æ¨¡å‹çš„åˆå§‹åŒ–ã€æ•°æ®é¢„å¤„ç†ã€åå¤„ç†ã€æŒ‡æ ‡æ›´æ–°å’Œè¯„ä¼°ç­‰åŠŸèƒ½ã€‚æ¯ä¸ªæ–¹æ³•éƒ½é™„æœ‰è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼Œä¾¿äºç†è§£å…¶åŠŸèƒ½å’Œå®ç°é€»è¾‘ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `val.py` æ˜¯ç”¨äºéªŒè¯åŸºäº YOLOï¼ˆYou Only Look Onceï¼‰æ¨¡å‹çš„å›¾åƒåˆ†å‰²ä»»åŠ¡çš„ã€‚å®ƒæ‰©å±•äº† `DetectionValidator` ç±»ï¼Œä¸“é—¨ç”¨äºå¤„ç†åˆ†å‰²æ¨¡å‹çš„éªŒè¯è¿‡ç¨‹ã€‚ç¨‹åºçš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹è¯„ä¼°ã€ç»“æœåå¤„ç†ä»¥åŠå¯è§†åŒ–ç­‰ã€‚

åœ¨åˆå§‹åŒ– `SegmentationValidator` ç±»æ—¶ï¼Œæ„é€ å‡½æ•°æ¥æ”¶ä¸€äº›å‚æ•°ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½å™¨ã€ä¿å­˜ç›®å½•ã€è¿›åº¦æ¡ã€å…¶ä»–å‚æ•°å’Œå›è°ƒå‡½æ•°ã€‚å®ƒè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¹¶è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºâ€œåˆ†å‰²â€ï¼ŒåŒæ—¶åˆå§‹åŒ–ç”¨äºè¯„ä¼°çš„æŒ‡æ ‡ `SegmentMetrics`ã€‚

åœ¨ `preprocess` æ–¹æ³•ä¸­ï¼Œè¾“å…¥çš„æ‰¹æ¬¡æ•°æ®ä¼šè¢«å¤„ç†ï¼Œå°†æ©ç ï¼ˆmaskï¼‰è½¬æ¢ä¸ºæµ®ç‚¹æ•°å¹¶ç§»åŠ¨åˆ°æŒ‡å®šçš„è®¾å¤‡ï¼ˆå¦‚ GPUï¼‰ã€‚`init_metrics` æ–¹æ³•ç”¨äºåˆå§‹åŒ–è¯„ä¼°æŒ‡æ ‡ï¼Œå¹¶æ ¹æ®æ˜¯å¦éœ€è¦ä¿å­˜ JSON æ–‡ä»¶æ¥é€‰æ‹©æ©ç å¤„ç†å‡½æ•°ã€‚

`get_desc` æ–¹æ³•è¿”å›æ ¼å¼åŒ–çš„è¯„ä¼°æŒ‡æ ‡æè¿°ï¼Œä¾¿äºåœ¨è¾“å‡ºä¸­æŸ¥çœ‹å„ç±»æŒ‡æ ‡çš„è¡¨ç°ã€‚`postprocess` æ–¹æ³•å¯¹ YOLO æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œè¿”å›å¤„ç†åçš„æ£€æµ‹ç»“æœå’ŒåŸå‹æ•°æ®ã€‚

åœ¨ `_prepare_batch` æ–¹æ³•ä¸­ï¼Œå‡†å¤‡è¾“å…¥æ‰¹æ¬¡æ•°æ®ï¼Œç¡®ä¿æ©ç æ•°æ®æ­£ç¡®å¤„ç†ã€‚`_prepare_pred` æ–¹æ³•åˆ™ç”¨äºå‡†å¤‡é¢„æµ‹ç»“æœå’Œæ©ç ã€‚`update_metrics` æ–¹æ³•è´Ÿè´£æ›´æ–°è¯„ä¼°æŒ‡æ ‡ï¼ŒåŒ…æ‹¬çœŸé˜³æ€§ï¼ˆTPï¼‰å’Œé¢„æµ‹æ©ç çš„å¤„ç†ã€‚

`finalize_metrics` æ–¹æ³•ç”¨äºè®¾ç½®è¯„ä¼°æŒ‡æ ‡çš„é€Ÿåº¦å’Œæ··æ·†çŸ©é˜µã€‚`_process_batch` æ–¹æ³•ç”¨äºå¤„ç†æ¯ä¸ªæ‰¹æ¬¡çš„æ£€æµ‹ç»“æœï¼Œè®¡ç®—ä¸çœŸå®æ ‡ç­¾çš„é‡å ç¨‹åº¦ï¼ˆIoUï¼‰ï¼Œå¹¶è¿”å›æ­£ç¡®çš„é¢„æµ‹çŸ©é˜µã€‚

åœ¨ `plot_val_samples` å’Œ `plot_predictions` æ–¹æ³•ä¸­ï¼Œç¨‹åºä¼šå°†éªŒè¯æ ·æœ¬å’Œé¢„æµ‹ç»“æœå¯è§†åŒ–ï¼Œä¾¿äºè§‚å¯Ÿæ¨¡å‹çš„æ€§èƒ½ã€‚`pred_to_json` æ–¹æ³•åˆ™å°†é¢„æµ‹ç»“æœä¿å­˜ä¸º JSON æ ¼å¼ï¼Œä¾¿äºåç»­åˆ†æå’Œè¯„ä¼°ã€‚

æœ€åï¼Œ`eval_json` æ–¹æ³•ç”¨äºè¿”å› COCO é£æ ¼çš„ç›®æ ‡æ£€æµ‹è¯„ä¼°æŒ‡æ ‡ï¼Œæ”¯æŒä½¿ç”¨ pycocotools è¿›è¡Œè¯„ä¼°ï¼Œè®¡ç®—æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„ mAPï¼ˆå¹³å‡ç²¾åº¦å‡å€¼ï¼‰ç­‰æŒ‡æ ‡ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„å›¾åƒåˆ†å‰²æ¨¡å‹éªŒè¯æµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹è¯„ä¼°ã€ç»“æœå¤„ç†å’Œå¯è§†åŒ–ç­‰åŠŸèƒ½ï¼Œé€‚ç”¨äºä½¿ç”¨ YOLO æ¨¡å‹è¿›è¡Œåˆ†å‰²ä»»åŠ¡çš„åœºæ™¯ã€‚

#### 11.5 code\ultralytics\data\base.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import glob
import os
from pathlib import Path
import cv2
import numpy as np
from torch.utils.data import Dataset

class BaseDataset(Dataset):
    """
    åŸºç¡€æ•°æ®é›†ç±»ï¼Œç”¨äºåŠ è½½å’Œå¤„ç†å›¾åƒæ•°æ®ã€‚

    å‚æ•°:
        img_path (str): å›¾åƒæ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚
        imgsz (int, optional): å›¾åƒå¤§å°ï¼Œé»˜è®¤ä¸º640ã€‚
        augment (bool, optional): æ˜¯å¦åº”ç”¨æ•°æ®å¢å¼ºï¼Œé»˜è®¤ä¸ºTrueã€‚
        classes (list): åŒ…å«çš„ç±»åˆ«åˆ—è¡¨ï¼Œé»˜è®¤ä¸ºNoneã€‚
    """

    def __init__(self, img_path, imgsz=640, augment=True, classes=None):
        """åˆå§‹åŒ–BaseDatasetç±»ï¼Œè®¾ç½®é…ç½®å’Œé€‰é¡¹ã€‚"""
        super().__init__()
        self.img_path = img_path  # å›¾åƒè·¯å¾„
        self.imgsz = imgsz  # å›¾åƒå¤§å°
        self.augment = augment  # æ˜¯å¦è¿›è¡Œæ•°æ®å¢å¼º
        self.im_files = self.get_img_files(self.img_path)  # è·å–å›¾åƒæ–‡ä»¶åˆ—è¡¨
        self.labels = self.get_labels()  # è·å–æ ‡ç­¾
        self.update_labels(include_class=classes)  # æ›´æ–°æ ‡ç­¾ä»¥åŒ…å«æŒ‡å®šç±»åˆ«
        self.ni = len(self.labels)  # æ•°æ®é›†ä¸­å›¾åƒçš„æ•°é‡

    def get_img_files(self, img_path):
        """è¯»å–å›¾åƒæ–‡ä»¶ã€‚"""
        f = []  # å­˜å‚¨å›¾åƒæ–‡ä»¶è·¯å¾„
        # éå†å›¾åƒè·¯å¾„
        for p in img_path if isinstance(img_path, list) else [img_path]:
            p = Path(p)  # ä½¿ç”¨Pathå¤„ç†è·¯å¾„
            if p.is_dir():  # å¦‚æœæ˜¯ç›®å½•
                f += glob.glob(str(p / "**" / "*.*"), recursive=True)  # è·å–ç›®å½•ä¸‹æ‰€æœ‰å›¾åƒæ–‡ä»¶
            elif p.is_file():  # å¦‚æœæ˜¯æ–‡ä»¶
                with open(p) as t:
                    t = t.read().strip().splitlines()  # è¯»å–æ–‡ä»¶å†…å®¹
                    parent = str(p.parent) + os.sep
                    f += [x.replace("./", parent) if x.startswith("./") else x for x in t]  # è½¬æ¢ä¸ºå…¨å±€è·¯å¾„
            else:
                raise FileNotFoundError(f"{p} ä¸å­˜åœ¨")
        # è¿‡æ»¤å‡ºæœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶
        im_files = sorted(x for x in f if x.split(".")[-1].lower() in ['jpg', 'jpeg', 'png', 'bmp'])
        assert im_files, f"åœ¨ {img_path} ä¸­æœªæ‰¾åˆ°å›¾åƒ"
        return im_files

    def update_labels(self, include_class):
        """æ›´æ–°æ ‡ç­¾ä»¥ä»…åŒ…å«æŒ‡å®šç±»åˆ«ï¼ˆå¯é€‰ï¼‰ã€‚"""
        for i in range(len(self.labels)):
            if include_class is not None:
                cls = self.labels[i]["cls"]
                bboxes = self.labels[i]["bboxes"]
                # è¿‡æ»¤æ ‡ç­¾
                j = np.isin(cls, include_class)
                self.labels[i]["cls"] = cls[j]
                self.labels[i]["bboxes"] = bboxes[j]

    def load_image(self, i):
        """åŠ è½½æ•°æ®é›†ä¸­ç´¢å¼•ä¸º 'i' çš„å›¾åƒï¼Œè¿”å›å›¾åƒåŠå…¶åŸå§‹å’Œè°ƒæ•´åçš„å°ºå¯¸ã€‚"""
        im = cv2.imread(self.im_files[i])  # è¯»å–å›¾åƒ
        if im is None:
            raise FileNotFoundError(f"æœªæ‰¾åˆ°å›¾åƒ {self.im_files[i]}")
        # è°ƒæ•´å›¾åƒå¤§å°
        im = cv2.resize(im, (self.imgsz, self.imgsz), interpolation=cv2.INTER_LINEAR)
        return im

    def __getitem__(self, index):
        """è¿”å›ç»™å®šç´¢å¼•çš„å›¾åƒå’Œæ ‡ç­¾ä¿¡æ¯ã€‚"""
        label = self.labels[index]  # è·å–æ ‡ç­¾
        label["img"] = self.load_image(index)  # åŠ è½½å›¾åƒ
        return label

    def __len__(self):
        """è¿”å›æ•°æ®é›†ä¸­æ ‡ç­¾çš„æ•°é‡ã€‚"""
        return len(self.labels)

    def get_labels(self):
        """ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ ‡ç­¾æ ¼å¼ï¼Œè¿™é‡Œè¿”å›ä¸€ä¸ªç¤ºä¾‹ã€‚"""
        # è¿™é‡Œåº”è¿”å›ä¸€ä¸ªåŒ…å«æ ‡ç­¾ä¿¡æ¯çš„å­—å…¸
        raise NotImplementedError
```

### ä»£ç è¯´æ˜ï¼š
1. **ç±»å®šä¹‰**ï¼š`BaseDataset`ç±»ç»§æ‰¿è‡ª`Dataset`ï¼Œç”¨äºå¤„ç†å›¾åƒæ•°æ®é›†ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼šæ„é€ å‡½æ•°æ¥æ”¶å›¾åƒè·¯å¾„ã€å›¾åƒå¤§å°ã€æ•°æ®å¢å¼ºæ ‡å¿—å’Œç±»åˆ«åˆ—è¡¨ï¼Œå¹¶åˆå§‹åŒ–ç›¸å…³å±æ€§ã€‚
3. **è·å–å›¾åƒæ–‡ä»¶**ï¼š`get_img_files`æ–¹æ³•ç”¨äºè¯»å–æŒ‡å®šè·¯å¾„ä¸‹çš„æ‰€æœ‰å›¾åƒæ–‡ä»¶ï¼Œå¹¶è¿”å›æœ‰æ•ˆçš„å›¾åƒæ–‡ä»¶åˆ—è¡¨ã€‚
4. **æ›´æ–°æ ‡ç­¾**ï¼š`update_labels`æ–¹æ³•æ ¹æ®ç»™å®šçš„ç±»åˆ«åˆ—è¡¨æ›´æ–°æ ‡ç­¾ï¼Œåªä¿ç•™æŒ‡å®šç±»åˆ«çš„æ ‡ç­¾ã€‚
5. **åŠ è½½å›¾åƒ**ï¼š`load_image`æ–¹æ³•æ ¹æ®ç´¢å¼•åŠ è½½å›¾åƒï¼Œå¹¶è°ƒæ•´å…¶å¤§å°ã€‚
6. **è·å–é¡¹**ï¼š`__getitem__`æ–¹æ³•è¿”å›æŒ‡å®šç´¢å¼•çš„å›¾åƒå’Œæ ‡ç­¾ä¿¡æ¯ã€‚
7. **é•¿åº¦**ï¼š`__len__`æ–¹æ³•è¿”å›æ•°æ®é›†ä¸­æ ‡ç­¾çš„æ•°é‡ã€‚
8. **è·å–æ ‡ç­¾**ï¼š`get_labels`æ–¹æ³•éœ€è¦ç”¨æˆ·è‡ªå®šä¹‰å®ç°ï¼Œä»¥è¿”å›ç‰¹å®šæ ¼å¼çš„æ ‡ç­¾ä¿¡æ¯ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `BaseDataset` çš„ç±»ï¼Œä¸»è¦ç”¨äºåŠ è½½å’Œå¤„ç†å›¾åƒæ•°æ®ï¼Œç‰¹åˆ«æ˜¯åœ¨è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶ã€‚è¯¥ç±»ç»§æ‰¿è‡ª PyTorch çš„ `Dataset` ç±»ï¼Œæä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•å’Œå±æ€§æ¥æ”¯æŒå›¾åƒæ•°æ®çš„è¯»å–ã€é¢„å¤„ç†å’Œå¢å¼ºã€‚

åœ¨åˆå§‹åŒ–æ–¹æ³• `__init__` ä¸­ï¼Œç”¨æˆ·å¯ä»¥ä¼ å…¥å¤šä¸ªå‚æ•°æ¥é…ç½®æ•°æ®é›†çš„è¡Œä¸ºï¼Œä¾‹å¦‚å›¾åƒè·¯å¾„ã€å›¾åƒå¤§å°ã€æ˜¯å¦ç¼“å­˜å›¾åƒã€æ˜¯å¦è¿›è¡Œæ•°æ®å¢å¼ºç­‰ã€‚åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œç±»ä¼šè¯»å–æŒ‡å®šè·¯å¾„ä¸‹çš„å›¾åƒæ–‡ä»¶ï¼Œå¹¶è·å–å¯¹åº”çš„æ ‡ç­¾ä¿¡æ¯ã€‚æ ‡ç­¾ä¿¡æ¯ä¼šæ ¹æ®ç”¨æˆ·æŒ‡å®šçš„ç±»åˆ«è¿›è¡Œæ›´æ–°ï¼Œæ”¯æŒå•ç±»è®­ç»ƒå’Œå¤šç±»è®­ç»ƒçš„çµæ´»æ€§ã€‚

`get_img_files` æ–¹æ³•ç”¨äºè¯»å–å›¾åƒæ–‡ä»¶ï¼Œæ”¯æŒä»ç›®å½•æˆ–æ–‡ä»¶ä¸­è·å–å›¾åƒè·¯å¾„ï¼Œå¹¶ç¡®ä¿åªè·å–æŒ‡å®šæ ¼å¼çš„å›¾åƒæ–‡ä»¶ã€‚å¦‚æœæŒ‡å®šçš„è·¯å¾„æ— æ•ˆï¼Œæ–¹æ³•ä¼šæŠ›å‡º `FileNotFoundError`ã€‚åœ¨è·å–å›¾åƒæ–‡ä»¶æ—¶ï¼Œè¿˜å¯ä»¥æ ¹æ® `fraction` å‚æ•°æ¥æ§åˆ¶ä½¿ç”¨æ•°æ®é›†çš„æ¯”ä¾‹ã€‚

`update_labels` æ–¹æ³•åˆ™ç”¨äºæ›´æ–°æ ‡ç­¾ï¼Œåªä¿ç•™ç”¨æˆ·æŒ‡å®šçš„ç±»åˆ«ï¼Œé€‚ç”¨äºå¤šç±»å’Œå•ç±»è®­ç»ƒçš„éœ€æ±‚ã€‚`load_image` æ–¹æ³•è´Ÿè´£åŠ è½½æŒ‡å®šç´¢å¼•çš„å›¾åƒï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œå°ºå¯¸è°ƒæ•´ã€‚è¯¥æ–¹æ³•æ”¯æŒé•¿è¾¹è°ƒæ•´ä»¥ä¿æŒå›¾åƒçš„çºµæ¨ªæ¯”ï¼Œæˆ–ç›´æ¥æ‹‰ä¼¸å›¾åƒåˆ°æŒ‡å®šå¤§å°ã€‚

ç¼“å­˜åŠŸèƒ½æ˜¯è¯¥ç±»çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ã€‚`cache_images` æ–¹æ³•å¯ä»¥å°†å›¾åƒç¼“å­˜åˆ°å†…å­˜æˆ–ç£ç›˜ï¼Œä»¥åŠ å¿«åç»­çš„åŠ è½½é€Ÿåº¦ã€‚`check_cache_ram` æ–¹æ³•åˆ™ç”¨äºæ£€æŸ¥å½“å‰ç³»ç»Ÿçš„å†…å­˜æ˜¯å¦è¶³å¤Ÿå­˜å‚¨ç¼“å­˜çš„å›¾åƒï¼Œç¡®ä¿åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸ä¼šå› ä¸ºå†…å­˜ä¸è¶³è€Œå¯¼è‡´é”™è¯¯ã€‚

åœ¨å¤„ç†å›¾åƒæ—¶ï¼Œå¦‚æœå¯ç”¨äº†æ•°æ®å¢å¼ºï¼Œç±»ä¼šå°†å›¾åƒå’Œå…¶åŸå§‹å°ºå¯¸ä¿¡æ¯å­˜å‚¨åœ¨ä¸€ä¸ªç¼“å†²åŒºä¸­ï¼Œä»¥ä¾¿åœ¨è®­ç»ƒæ—¶è¿›è¡Œéšæœºå¢å¼ºã€‚`set_rectangle` æ–¹æ³•åˆ™ç”¨äºè®¾ç½®è¾¹ç•Œæ¡†çš„å½¢çŠ¶ï¼Œä»¥é€‚åº” YOLO æ£€æµ‹æ¨¡å‹çš„éœ€æ±‚ã€‚

ç±»çš„ `__getitem__` æ–¹æ³•è¿”å›æŒ‡å®šç´¢å¼•çš„å›¾åƒåŠå…¶æ ‡ç­¾ä¿¡æ¯ï¼Œå¹¶åº”ç”¨é¢„å®šä¹‰çš„å˜æ¢ã€‚`get_image_and_label` æ–¹æ³•åˆ™ç”¨äºè·å–å›¾åƒå’Œæ ‡ç­¾çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¹¶è®¡ç®—å›¾åƒçš„å¡«å……æ¯”ä¾‹ã€‚

æ­¤å¤–ï¼Œç±»è¿˜å®šä¹‰äº† `build_transforms` å’Œ `get_labels` æ–¹æ³•ï¼Œå…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ•°æ®å¢å¼ºå’Œæ ‡ç­¾æ ¼å¼ã€‚è¿™äº›æ–¹æ³•ç›®å‰æ˜¯æœªå®ç°çš„ï¼Œç”¨æˆ·éœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œå®ç°ã€‚

æ€»çš„æ¥è¯´ï¼Œ`BaseDataset` ç±»ä¸ºå›¾åƒæ•°æ®çš„åŠ è½½å’Œå¤„ç†æä¾›äº†ä¸€ä¸ªçµæ´»ä¸”é«˜æ•ˆçš„æ¡†æ¶ï¼Œé€‚ç”¨äºå„ç§æ·±åº¦å­¦ä¹ ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨ YOLO ç­‰ç›®æ ‡æ£€æµ‹æ¨¡å‹æ—¶ã€‚

#### 11.6 train.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
import random
import numpy as np
import torch.nn as nn
from ultralytics.data import build_dataloader, build_yolo_dataset
from ultralytics.engine.trainer import BaseTrainer
from ultralytics.models import yolo
from ultralytics.nn.tasks import DetectionModel
from ultralytics.utils import LOGGER, RANK
from ultralytics.utils.torch_utils import de_parallel, torch_distributed_zero_first

class DetectionTrainer(BaseTrainer):
    """
    æ‰©å±•è‡ª BaseTrainer ç±»ï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def build_dataset(self, img_path, mode="train", batch=None):
        """
        æ„å»º YOLO æ•°æ®é›†ã€‚

        å‚æ•°:
            img_path (str): åŒ…å«å›¾åƒçš„æ–‡ä»¶å¤¹è·¯å¾„ã€‚
            mode (str): æ¨¡å¼ï¼Œå¯ä»¥æ˜¯ 'train' æˆ– 'val'ï¼Œç”¨æˆ·å¯ä»¥ä¸ºæ¯ç§æ¨¡å¼è‡ªå®šä¹‰ä¸åŒçš„å¢å¼ºã€‚
            batch (int, optional): æ‰¹æ¬¡å¤§å°ï¼Œä»…ç”¨äº 'rect' æ¨¡å¼ã€‚é»˜è®¤ä¸º Noneã€‚
        """
        gs = max(int(de_parallel(self.model).stride.max() if self.model else 0), 32)  # è·å–æ¨¡å‹çš„æœ€å¤§æ­¥å¹…
        return build_yolo_dataset(self.args, img_path, batch, self.data, mode=mode, rect=mode == "val", stride=gs)

    def get_dataloader(self, dataset_path, batch_size=16, rank=0, mode="train"):
        """æ„é€ å¹¶è¿”å›æ•°æ®åŠ è½½å™¨ã€‚"""
        assert mode in ["train", "val"]  # ç¡®ä¿æ¨¡å¼æœ‰æ•ˆ
        with torch_distributed_zero_first(rank):  # åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œç¡®ä¿æ•°æ®é›†åªåˆå§‹åŒ–ä¸€æ¬¡
            dataset = self.build_dataset(dataset_path, mode, batch_size)  # æ„å»ºæ•°æ®é›†
        shuffle = mode == "train"  # è®­ç»ƒæ¨¡å¼ä¸‹æ‰“ä¹±æ•°æ®
        workers = self.args.workers if mode == "train" else self.args.workers * 2  # è®¾ç½®å·¥ä½œçº¿ç¨‹æ•°
        return build_dataloader(dataset, batch_size, workers, shuffle, rank)  # è¿”å›æ•°æ®åŠ è½½å™¨

    def preprocess_batch(self, batch):
        """å¯¹ä¸€æ‰¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬ç¼©æ”¾å’Œè½¬æ¢ä¸ºæµ®ç‚¹æ•°ã€‚"""
        batch["img"] = batch["img"].to(self.device, non_blocking=True).float() / 255  # å°†å›¾åƒè½¬ç§»åˆ°è®¾å¤‡å¹¶å½’ä¸€åŒ–
        if self.args.multi_scale:  # å¦‚æœå¯ç”¨å¤šå°ºåº¦
            imgs = batch["img"]
            sz = (
                random.randrange(self.args.imgsz * 0.5, self.args.imgsz * 1.5 + self.stride)
                // self.stride
                * self.stride
            )  # éšæœºé€‰æ‹©å›¾åƒå¤§å°
            sf = sz / max(imgs.shape[2:])  # è®¡ç®—ç¼©æ”¾å› å­
            if sf != 1:  # å¦‚æœéœ€è¦ç¼©æ”¾
                ns = [
                    math.ceil(x * sf / self.stride) * self.stride for x in imgs.shape[2:]
                ]  # è®¡ç®—æ–°çš„å½¢çŠ¶
                imgs = nn.functional.interpolate(imgs, size=ns, mode="bilinear", align_corners=False)  # è¿›è¡Œæ’å€¼ç¼©æ”¾
            batch["img"] = imgs  # æ›´æ–°æ‰¹æ¬¡å›¾åƒ
        return batch

    def set_model_attributes(self):
        """è®¾ç½®æ¨¡å‹çš„å±æ€§ï¼ŒåŒ…æ‹¬ç±»åˆ«æ•°é‡å’Œåç§°ã€‚"""
        self.model.nc = self.data["nc"]  # å°†ç±»åˆ«æ•°é‡é™„åŠ åˆ°æ¨¡å‹
        self.model.names = self.data["names"]  # å°†ç±»åˆ«åç§°é™„åŠ åˆ°æ¨¡å‹
        self.model.args = self.args  # å°†è¶…å‚æ•°é™„åŠ åˆ°æ¨¡å‹

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å› YOLO æ£€æµ‹æ¨¡å‹ã€‚"""
        model = DetectionModel(cfg, nc=self.data["nc"], verbose=verbose and RANK == -1)  # åˆ›å»ºæ£€æµ‹æ¨¡å‹
        if weights:
            model.load(weights)  # åŠ è½½æƒé‡
        return model

    def plot_training_samples(self, batch, ni):
        """ç»˜åˆ¶å¸¦æœ‰æ³¨é‡Šçš„è®­ç»ƒæ ·æœ¬ã€‚"""
        plot_images(
            images=batch["img"],
            batch_idx=batch["batch_idx"],
            cls=batch["cls"].squeeze(-1),
            bboxes=batch["bboxes"],
            paths=batch["im_file"],
            fname=self.save_dir / f"train_batch{ni}.jpg",
            on_plot=self.on_plot,
        )
```

### ä»£ç è¯´æ˜ï¼š
1. **DetectionTrainer ç±»**ï¼šç»§æ‰¿è‡ª `BaseTrainer`ï¼Œç”¨äºå®ç° YOLO æ¨¡å‹çš„è®­ç»ƒã€‚
2. **build_dataset æ–¹æ³•**ï¼šæ ¹æ®ç»™å®šçš„å›¾åƒè·¯å¾„å’Œæ¨¡å¼æ„å»ºæ•°æ®é›†ï¼Œæ”¯æŒè®­ç»ƒå’ŒéªŒè¯æ¨¡å¼ã€‚
3. **get_dataloader æ–¹æ³•**ï¼šæ„é€ æ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ã€‚
4. **preprocess_batch æ–¹æ³•**ï¼šå¯¹è¾“å…¥çš„å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å½’ä¸€åŒ–å’Œå¯é€‰çš„å¤šå°ºåº¦è°ƒæ•´ã€‚
5. **set_model_attributes æ–¹æ³•**ï¼šè®¾ç½®æ¨¡å‹çš„ç±»åˆ«æ•°é‡å’Œåç§°ç­‰å±æ€§ã€‚
6. **get_model æ–¹æ³•**ï¼šè¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
7. **plot_training_samples æ–¹æ³•**ï¼šç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶å¯¹åº”çš„æ ‡æ³¨ï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `train.py` æ˜¯ä¸€ä¸ªç”¨äºè®­ç»ƒ YOLOï¼ˆYou Only Look Onceï¼‰ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„å®ç°ï¼Œç»§æ‰¿è‡ª `BaseTrainer` ç±»ã€‚å®ƒåŒ…å«äº†ä¸€ç³»åˆ—æ–¹æ³•ï¼Œç”¨äºæ„å»ºæ•°æ®é›†ã€åŠ è½½æ•°æ®ã€é¢„å¤„ç†å›¾åƒã€è®¾ç½®æ¨¡å‹å±æ€§ã€è·å–æ¨¡å‹ã€éªŒè¯æ¨¡å‹ã€è®°å½•æŸå¤±ã€ç»˜åˆ¶è®­ç»ƒæ ·æœ¬å’Œç»˜åˆ¶è®­ç»ƒæŒ‡æ ‡ç­‰ã€‚

é¦–å…ˆï¼Œ`DetectionTrainer` ç±»çš„æ„é€ å‡½æ•°ä¸­å®šä¹‰äº†æ¨¡å‹çš„åŸºæœ¬å±æ€§ï¼ŒåŒ…æ‹¬æ•°æ®é›†çš„è·¯å¾„ã€æ¨¡å‹çš„é…ç½®ã€è®­ç»ƒçš„è½®æ•°ç­‰ã€‚`build_dataset` æ–¹æ³•ç”¨äºæ„å»º YOLO æ•°æ®é›†ï¼Œæ¥æ”¶å›¾åƒè·¯å¾„ã€æ¨¡å¼ï¼ˆè®­ç»ƒæˆ–éªŒè¯ï¼‰å’Œæ‰¹æ¬¡å¤§å°ä½œä¸ºå‚æ•°ã€‚å®ƒé€šè¿‡è°ƒç”¨ `build_yolo_dataset` å‡½æ•°æ¥åˆ›å»ºæ•°æ®é›†ï¼Œæ”¯æŒä¸åŒæ¨¡å¼ä¸‹çš„å¢å¼ºã€‚

`get_dataloader` æ–¹æ³•åˆ™ç”¨äºæ„å»ºå¹¶è¿”å›æ•°æ®åŠ è½½å™¨ï¼Œç¡®ä¿åœ¨åˆ†å¸ƒå¼è®­ç»ƒæ—¶åªåˆå§‹åŒ–ä¸€æ¬¡æ•°æ®é›†ã€‚å®ƒæ ¹æ®æ¨¡å¼å†³å®šæ˜¯å¦æ‰“ä¹±æ•°æ®ï¼Œå¹¶æ ¹æ®å·¥ä½œçº¿ç¨‹æ•°è¿›è¡Œè®¾ç½®ã€‚`preprocess_batch` æ–¹æ³•è´Ÿè´£å¯¹å›¾åƒæ‰¹æ¬¡è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬å°†å›¾åƒç¼©æ”¾åˆ°é€‚å½“çš„å¤§å°å¹¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°æ ¼å¼ã€‚

åœ¨è®¾ç½®æ¨¡å‹å±æ€§çš„ `set_model_attributes` æ–¹æ³•ä¸­ï¼Œæ¨¡å‹çš„ç±»åˆ«æ•°å’Œç±»åˆ«åç§°è¢«é™„åŠ åˆ°æ¨¡å‹ä¸Šï¼Œä»¥ä¾¿äºåç»­çš„è®­ç»ƒå’Œè¯„ä¼°ã€‚`get_model` æ–¹æ³•è¿”å›ä¸€ä¸ª YOLO æ£€æµ‹æ¨¡å‹å®ä¾‹ï¼Œå¹¶å¯é€‰æ‹©åŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚

`get_validator` æ–¹æ³•è¿”å›ä¸€ä¸ªç”¨äºéªŒè¯æ¨¡å‹çš„ `DetectionValidator` å®ä¾‹ï¼Œè´Ÿè´£è®¡ç®—å’Œè®°å½•æ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„æŸå¤±ã€‚`label_loss_items` æ–¹æ³•ç”¨äºè¿”å›å¸¦æœ‰æ ‡ç­¾çš„è®­ç»ƒæŸå¤±å­—å…¸ï¼Œä¾¿äºç›‘æ§è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±å˜åŒ–ã€‚

`progress_string` æ–¹æ³•ç”Ÿæˆä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œæ˜¾ç¤ºè®­ç»ƒè¿›åº¦ï¼ŒåŒ…æ‹¬å½“å‰è½®æ¬¡ã€GPU å†…å­˜ä½¿ç”¨æƒ…å†µã€æŸå¤±å€¼ã€å®ä¾‹æ•°é‡å’Œå›¾åƒå¤§å°ç­‰ä¿¡æ¯ã€‚`plot_training_samples` æ–¹æ³•ç”¨äºç»˜åˆ¶è®­ç»ƒæ ·æœ¬åŠå…¶æ ‡æ³¨ï¼Œä¾¿äºå¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ•°æ®ã€‚

æœ€åï¼Œ`plot_metrics` å’Œ `plot_training_labels` æ–¹æ³•åˆ†åˆ«ç”¨äºç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­è®°å½•çš„æŒ‡æ ‡å’Œåˆ›å»ºå¸¦æ ‡ç­¾çš„è®­ç»ƒå›¾ï¼Œä»¥ä¾¿äºåˆ†ææ¨¡å‹çš„è®­ç»ƒæ•ˆæœå’Œæ€§èƒ½ã€‚

æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº† YOLO æ¨¡å‹è®­ç»ƒçš„å„ä¸ªæ–¹é¢ï¼Œæä¾›äº†ä»æ•°æ®åŠ è½½åˆ°æ¨¡å‹è¯„ä¼°çš„å®Œæ•´æµç¨‹ï¼Œé€‚åˆç”¨äºç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„è®­ç»ƒå’Œè°ƒè¯•ã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº YOLOv8 çš„ç›®æ ‡æ£€æµ‹å’Œå›¾åƒåˆ†å‰²æ¨¡å‹çš„å®ç°ï¼ŒåŒ…å«äº†å¤šä¸ªæ¨¡å—å’Œæ–‡ä»¶ï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªå®Œæ•´çš„è®­ç»ƒã€éªŒè¯å’Œæ¨ç†æ¡†æ¶ã€‚æ•´ä½“æ¶æ„åŒ…æ‹¬æ•°æ®å¤„ç†ã€æ¨¡å‹å®šä¹‰ã€è®­ç»ƒè¿‡ç¨‹ã€éªŒè¯è¿‡ç¨‹ä»¥åŠå¯è§†åŒ–å·¥å…·ç­‰ã€‚æ¯ä¸ªæ¨¡å—éƒ½æœ‰å…¶ç‰¹å®šçš„åŠŸèƒ½ï¼ŒååŒå·¥ä½œä»¥å®ç°é«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²ä»»åŠ¡ã€‚

- **æ•°æ®å¤„ç†**ï¼šåŒ…æ‹¬æ•°æ®é›†çš„åŠ è½½ã€é¢„å¤„ç†å’Œå¢å¼ºï¼Œç¡®ä¿æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ¥æ”¶åˆ°é«˜è´¨é‡çš„æ•°æ®ã€‚
- **æ¨¡å‹å®šä¹‰**ï¼šå®šä¹‰äº†ä¸åŒçš„ YOLO æ¨¡å‹å’Œå…¶ä»–ç›¸å…³æ¨¡å‹ï¼ˆå¦‚ SAMï¼‰ï¼Œæä¾›äº†çµæ´»çš„ç½‘ç»œç»“æ„å’Œç»„ä»¶ã€‚
- **è®­ç»ƒå’ŒéªŒè¯**ï¼šå®ç°äº†è®­ç»ƒè¿‡ç¨‹çš„æ§åˆ¶ï¼ŒåŒ…æ‹¬æŸå¤±è®¡ç®—ã€æ¨¡å‹è¯„ä¼°å’Œæ€§èƒ½ç›‘æ§ã€‚
- **å¯è§†åŒ–**ï¼šæä¾›äº†ç»˜åˆ¶è®­ç»ƒæ ·æœ¬å’Œè¯„ä¼°æŒ‡æ ‡çš„åŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£æ¨¡å‹çš„è¡¨ç°ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                                                                         | åŠŸèƒ½æè¿°                                                         |
|--------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| `C:\shangjia\code\70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\sam\model.py` | å®ç° Segment Anything Model (SAM) çš„æ¥å£å’Œé¢„æµ‹åŠŸèƒ½ã€‚            |
| `C:\shangjia\code\70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\nn\extra_modules\block.py` | å®šä¹‰å¤šç§ç¥ç»ç½‘ç»œæ¨¡å—å’Œå±‚ï¼Œä¼˜åŒ–è®¡ç®—æ•ˆç‡å’Œæ¨¡å‹æ€§èƒ½ã€‚              |
| `C:\shangjia\code\ui.py`                                                                        | å¯åŠ¨ Streamlit åº”ç”¨çš„è„šæœ¬ï¼Œæä¾›ç”¨æˆ·ç•Œé¢ä»¥è¿è¡Œæ¨¡å‹ã€‚              |
| `C:\shangjia\code\code\ultralytics\models\yolo\segment\val.py`                                | å®ç°åˆ†å‰²æ¨¡å‹çš„éªŒè¯è¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®é¢„å¤„ç†å’Œè¯„ä¼°æŒ‡æ ‡è®¡ç®—ã€‚          |
| `C:\shangjia\code\code\ultralytics\data\base.py`                                              | å®šä¹‰åŸºç¡€æ•°æ®é›†ç±»ï¼Œè´Ÿè´£å›¾åƒæ•°æ®çš„åŠ è½½ã€é¢„å¤„ç†å’Œå¢å¼ºã€‚            |
| `C:\shangjia\code\train.py`                                                                     | å®ç° YOLO æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®åŠ è½½ã€æ¨¡å‹è®¾ç½®å’ŒæŸå¤±è®°å½•ã€‚    |
| `C:\shangjia\code\code\ultralytics\hub\auth.py`                                               | å¤„ç†ç”¨æˆ·è®¤è¯å’Œæ¨¡å‹ä¸‹è½½çš„ç›¸å…³åŠŸèƒ½ã€‚                              |
| `C:\shangjia\code\code\ultralytics\models\rtdetr\train.py`                                    | å®ç° RT-DETR æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ï¼Œä¸“æ³¨äºå®æ—¶ç›®æ ‡æ£€æµ‹ã€‚                |
| `C:\shangjia\code\code\ultralytics\nn\tasks.py`                                               | å®šä¹‰ä¸åŒçš„ä»»åŠ¡ï¼ˆå¦‚æ£€æµ‹ã€åˆ†å‰²ï¼‰çš„æ¥å£å’ŒåŠŸèƒ½ã€‚                    |
| `C:\shangjia\code\code\ultralytics\models\yolo\model.py`                                      | å®šä¹‰ YOLO æ¨¡å‹çš„ç»“æ„å’Œå‰å‘ä¼ æ’­é€»è¾‘ã€‚                             |
| `C:\shangjia\code\70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\utils\plotting.py` | æä¾›å¯è§†åŒ–å·¥å…·ï¼Œç”¨äºç»˜åˆ¶è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ ·æœ¬å’ŒæŒ‡æ ‡ã€‚                |
| `C:\shangjia\code\70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\data\converter.py` | å¤„ç†æ•°æ®æ ¼å¼è½¬æ¢ï¼Œæ”¯æŒä¸åŒæ•°æ®é›†æ ¼å¼çš„åŠ è½½ã€‚                    |
| `C:\shangjia\code\70+ç§YOLOv8ç®—æ³•æ”¹è¿›æºç å¤§å…¨å’Œè°ƒè¯•åŠ è½½è®­ç»ƒæ•™ç¨‹ï¼ˆéå¿…è¦ï¼‰\ultralytics\models\sam\modules\tiny_encoder.py` | å®šä¹‰ SAM æ¨¡å‹ä¸­çš„ç¼–ç å™¨æ¨¡å—ï¼Œå¤„ç†è¾“å…¥æ•°æ®çš„ç‰¹å¾æå–ã€‚          |

ä»¥ä¸Šè¡¨æ ¼æ€»ç»“äº†æ¯ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº†è¯¥é¡¹ç›®çš„æ•´ä½“æ¶æ„å’Œå„ä¸ªæ¨¡å—ä¹‹é—´çš„å…³ç³»ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/ZpyUl5ts](https://mbd.pub/o/bread/ZpyUl5ts)